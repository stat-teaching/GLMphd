<!DOCTYPE html>
<html lang="en">
<head>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <meta charset="utf-8">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" rel="stylesheet"/>
  <meta name="generator" content="quarto-1.8.21" />

  <meta name="author" content="Filippo Gambarota">
  <title>Generalized Linear Models – Binomial GLM</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-17444cc896c82453f4d942fa9ebb519e.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide">
  <h1 class="title">Binomial GLM</h1>
  <p class="subtitle">Psychological Sciences</p>
  <p class="author">Filippo Gambarota</p>
  <p class="institute">University of Padova</p>
  <p class="date"><em>Last modified: 02-09-2025</em></p>
</section>
<section id="example-passing-the-exam" class="slide level2">
<h2>Example: Passing the exam</h2>
<p>We want to measure the impact of <strong>watching tv-shows</strong> on the probability of <strong>passing the statistics exam</strong>.</p>
<ul>
<li class="fragment"><code>exam</code>: <strong>passing the exam</strong> (1 = “passed”, 0 = “failed”)</li>
<li class="fragment"><code>tv_shows</code>: <strong>watching tv-shows regularly</strong> (1 = “yes”, 0 = “no”)</li>
</ul>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="nfdqqvibsb" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#nfdqqvibsb table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#nfdqqvibsb thead, #nfdqqvibsb tbody, #nfdqqvibsb tfoot, #nfdqqvibsb tr, #nfdqqvibsb td, #nfdqqvibsb th {
  border-style: none;
}

#nfdqqvibsb p {
  margin: 0;
  padding: 0;
}

#nfdqqvibsb .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#nfdqqvibsb .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#nfdqqvibsb .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#nfdqqvibsb .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#nfdqqvibsb .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nfdqqvibsb .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nfdqqvibsb .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#nfdqqvibsb .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#nfdqqvibsb .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#nfdqqvibsb .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#nfdqqvibsb .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#nfdqqvibsb .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#nfdqqvibsb .gt_spanner_row {
  border-bottom-style: hidden;
}

#nfdqqvibsb .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#nfdqqvibsb .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#nfdqqvibsb .gt_from_md > :first-child {
  margin-top: 0;
}

#nfdqqvibsb .gt_from_md > :last-child {
  margin-bottom: 0;
}

#nfdqqvibsb .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#nfdqqvibsb .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#nfdqqvibsb .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#nfdqqvibsb .gt_row_group_first td {
  border-top-width: 2px;
}

#nfdqqvibsb .gt_row_group_first th {
  border-top-width: 2px;
}

#nfdqqvibsb .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nfdqqvibsb .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#nfdqqvibsb .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#nfdqqvibsb .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nfdqqvibsb .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#nfdqqvibsb .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#nfdqqvibsb .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#nfdqqvibsb .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#nfdqqvibsb .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#nfdqqvibsb .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nfdqqvibsb .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nfdqqvibsb .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#nfdqqvibsb .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#nfdqqvibsb .gt_left {
  text-align: left;
}

#nfdqqvibsb .gt_center {
  text-align: center;
}

#nfdqqvibsb .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#nfdqqvibsb .gt_font_normal {
  font-weight: normal;
}

#nfdqqvibsb .gt_font_bold {
  font-weight: bold;
}

#nfdqqvibsb .gt_font_italic {
  font-style: italic;
}

#nfdqqvibsb .gt_super {
  font-size: 65%;
}

#nfdqqvibsb .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#nfdqqvibsb .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#nfdqqvibsb .gt_indent_1 {
  text-indent: 5px;
}

#nfdqqvibsb .gt_indent_2 {
  text-indent: 10px;
}

#nfdqqvibsb .gt_indent_3 {
  text-indent: 15px;
}

#nfdqqvibsb .gt_indent_4 {
  text-indent: 20px;
}

#nfdqqvibsb .gt_indent_5 {
  text-indent: 25px;
}

#nfdqqvibsb .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#nfdqqvibsb div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="tv_shows" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">tv_shows</th>
<th id="exam" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">exam</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="tv_shows">1</td>
<td class="gt_row gt_center" headers="exam">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="tv_shows">1</td>
<td class="gt_row gt_center" headers="exam">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="tv_shows">1</td>
<td class="gt_row gt_center" headers="exam">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="tv_shows">1</td>
<td class="gt_row gt_center" headers="exam">1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="tv_shows">...</td>
<td class="gt_row gt_center" headers="exam">...</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="tv_shows">0</td>
<td class="gt_row gt_center" headers="exam">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="tv_shows">0</td>
<td class="gt_row gt_center" headers="exam">0</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="tv_shows">0</td>
<td class="gt_row gt_center" headers="exam">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="tv_shows">0</td>
<td class="gt_row gt_center" headers="exam">0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="example-passing-the-exam-1" class="slide level2">
<h2>Example: Passing the exam</h2>
<p>We can create the <strong>contingency table</strong></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(<span class="sc">~</span>exam <span class="sc">+</span> tv_shows, <span class="at">data =</span> dat) <span class="sc">|&gt;</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">addmargins</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      tv_shows
#&gt; exam    0   1 Sum
#&gt;   0    36  13  49
#&gt;   1    14  37  51
#&gt;   Sum  50  50 100</code></pre>
</div>
</div>
</section>
<section id="example-passing-the-exam-2" class="slide level2">
<h2>Example: Passing the exam</h2>
<p>Each cell probability <span class="math inline">\(p_{ij}\)</span> is computed as <span class="math inline">\(p_{ij}/n\)</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">xtabs</span>(<span class="sc">~</span>exam <span class="sc">+</span> tv_shows, <span class="at">data =</span> dat)<span class="sc">/</span>n) <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">addmargins</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      tv_shows
#&gt; exam     0    1  Sum
#&gt;   0   0.36 0.13 0.49
#&gt;   1   0.14 0.37 0.51
#&gt;   Sum 0.50 0.50 1.00</code></pre>
</div>
</div>
</section>
<section id="example-passing-the-exam---odds" class="slide level2">
<h2>Example: Passing the exam - Odds</h2>
<p>The most common way to analyze a 2x2 contingency table is using the <strong>odds ratio</strong> (OR). Firsly let’s define <em>the odds of success</em> as:</p>
<p><span class="math display">\[\begin{align*}
odds = \frac{p}{1 - p} \\
p = \frac{odds}{odds + 1}
\end{align*}\]</span></p>
<ul>
<li class="fragment">the <strong>odds</strong> are non-negative, ranging between 0 and <span class="math inline">\(+\infty\)</span></li>
<li class="fragment">an <strong>odds</strong> of e.g. 3 means that we expect 3 <em>success</em> for each <em>failure</em></li>
</ul>
</section>
<section id="example-passing-the-exam---odds-1" class="slide level2">
<h2>Example: Passing the exam - Odds</h2>
<p>For the <code>exam</code> example:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>odds <span class="ot">&lt;-</span> <span class="cf">function</span>(p) p <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> p)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">with</span>(dat, exam[tv_shows <span class="sc">==</span> <span class="dv">1</span>])) <span class="co"># passing exam | tv_shows</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>p11</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.74</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">odds</span>(p11)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 2.846154</code></pre>
</div>
</div>
</section>
<section id="example-passing-the-exam---odds-ratio" class="slide level2">
<h2>Example: Passing the exam - Odds Ratio</h2>
<p>The OR is a ratio of odds:</p>
<p><span class="math display">\[
OR = \frac{\frac{p_1}{1 - p_1}}{\frac{p_2}{1 - p_2}}
\]</span></p>
<ul>
<li class="fragment">OR ranges between 0 and <span class="math inline">\(+\infty\)</span>. When <span class="math inline">\(OR = 1\)</span> the odds for the two conditions are equal</li>
<li class="fragment">An e.g. <span class="math inline">\(OR = 3\)</span> means that being in the condition at the numerator increase 3 times the odds of success</li>
</ul>
</section>
<section id="example-passing-the-exam---odds-ratio-1" class="slide level2">
<h2>Example: Passing the exam - Odds Ratio</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>odds_ratio <span class="ot">&lt;-</span> <span class="cf">function</span>(p1, p2) <span class="fu">odds</span>(p1) <span class="sc">/</span> <span class="fu">odds</span>(p2)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p11 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">with</span>(dat, exam[tv_shows <span class="sc">==</span> <span class="dv">1</span>])) <span class="co"># passing exam | tv_shows</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>p10 <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">with</span>(dat, exam[tv_shows <span class="sc">==</span> <span class="dv">0</span>])) <span class="co"># passing exam | not tv_shows</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>p11</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.74</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>p10</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.28</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">odds_ratio</span>(p11, p10)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 7.318681</code></pre>
</div>
</div>
</section>
<section id="why-using-these-measure" class="slide level2">
<h2>Why using these measure?</h2>
<p>The odds have an interesting property when taking the logarithm. We can express a probability <span class="math inline">\(p\)</span> using a scale ranging <span class="math inline">\([-\infty, +\infty]\)</span></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-7-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="another-example-teddy-child" class="slide level2">
<h2>Another example, <strong>Teddy Child</strong></h2>
<p>We considered a Study conducted by the University of Padua (TEDDY Child Study, 2020)<a href="#/fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Within the study, researchers asked the participants (mothers of a young child) about the presence of post-partum depression and measured the parental stress using the PSI-Parenting Stress Index.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="eofottvpyy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#eofottvpyy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#eofottvpyy thead, #eofottvpyy tbody, #eofottvpyy tfoot, #eofottvpyy tr, #eofottvpyy td, #eofottvpyy th {
  border-style: none;
}

#eofottvpyy p {
  margin: 0;
  padding: 0;
}

#eofottvpyy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#eofottvpyy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#eofottvpyy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#eofottvpyy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#eofottvpyy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eofottvpyy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eofottvpyy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#eofottvpyy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#eofottvpyy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#eofottvpyy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#eofottvpyy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#eofottvpyy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#eofottvpyy .gt_spanner_row {
  border-bottom-style: hidden;
}

#eofottvpyy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#eofottvpyy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#eofottvpyy .gt_from_md > :first-child {
  margin-top: 0;
}

#eofottvpyy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#eofottvpyy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#eofottvpyy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#eofottvpyy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#eofottvpyy .gt_row_group_first td {
  border-top-width: 2px;
}

#eofottvpyy .gt_row_group_first th {
  border-top-width: 2px;
}

#eofottvpyy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eofottvpyy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#eofottvpyy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#eofottvpyy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eofottvpyy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#eofottvpyy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#eofottvpyy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#eofottvpyy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#eofottvpyy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#eofottvpyy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eofottvpyy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eofottvpyy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#eofottvpyy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#eofottvpyy .gt_left {
  text-align: left;
}

#eofottvpyy .gt_center {
  text-align: center;
}

#eofottvpyy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#eofottvpyy .gt_font_normal {
  font-weight: normal;
}

#eofottvpyy .gt_font_bold {
  font-weight: bold;
}

#eofottvpyy .gt_font_italic {
  font-style: italic;
}

#eofottvpyy .gt_super {
  font-size: 65%;
}

#eofottvpyy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#eofottvpyy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#eofottvpyy .gt_indent_1 {
  text-indent: 5px;
}

#eofottvpyy .gt_indent_2 {
  text-indent: 10px;
}

#eofottvpyy .gt_indent_3 {
  text-indent: 15px;
}

#eofottvpyy .gt_indent_4 {
  text-indent: 20px;
}

#eofottvpyy .gt_indent_5 {
  text-indent: 25px;
}

#eofottvpyy .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#eofottvpyy div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="ID" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">ID</th>
<th id="Parental_stress" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Parental_stress</th>
<th id="Depression_pp" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold" scope="col">Depression_pp</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="ID">1</td>
<td class="gt_row gt_center" headers="Parental_stress">75</td>
<td class="gt_row gt_center" headers="Depression_pp">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="ID">2</td>
<td class="gt_row gt_center" headers="Parental_stress">51</td>
<td class="gt_row gt_center" headers="Depression_pp">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="ID">3</td>
<td class="gt_row gt_center" headers="Parental_stress">76</td>
<td class="gt_row gt_center" headers="Depression_pp">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="ID">4</td>
<td class="gt_row gt_center" headers="Parental_stress">88</td>
<td class="gt_row gt_center" headers="Depression_pp">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="ID">...</td>
<td class="gt_row gt_center" headers="Parental_stress">...</td>
<td class="gt_row gt_center" headers="Depression_pp">...</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="ID">376</td>
<td class="gt_row gt_center" headers="Parental_stress">67</td>
<td class="gt_row gt_center" headers="Depression_pp">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="ID">377</td>
<td class="gt_row gt_center" headers="Parental_stress">71</td>
<td class="gt_row gt_center" headers="Depression_pp">No</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="ID">378</td>
<td class="gt_row gt_center" headers="Parental_stress">63</td>
<td class="gt_row gt_center" headers="Depression_pp">No</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="ID">379</td>
<td class="gt_row gt_center" headers="Parental_stress">70</td>
<td class="gt_row gt_center" headers="Depression_pp">No</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="another-example-teddy-child-1" class="slide level2">
<h2>Another example, <strong>Teddy Child</strong></h2>
<p>We want to see if the parental stress increase the probability of having post-partum depression:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-9-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="another-example-teddy-child-2" class="slide level2">
<h2>Another example, <strong>Teddy Child</strong></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-10-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="another-example-teddy-child-3" class="slide level2">
<h2>Another example, <strong>Teddy Child</strong></h2>
<p>Let’s start by fitting a linear model <code>Depression_pp ~ Parental_stress</code>. We consider “Yes” as 1 and “No” as 0.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(Depression_pp01 <span class="sc">~</span> Parental_stress, <span class="at">data =</span> teddy)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; lm(formula = Depression_pp01 ~ Parental_stress, data = teddy)
#&gt; 
#&gt; Residuals:
#&gt;      Min       1Q   Median       3Q      Max 
#&gt; -0.42473 -0.13768 -0.10003 -0.05768  0.94702 
#&gt; 
#&gt; Coefficients:
#&gt;                  Estimate Std. Error t value Pr(&gt;|t|)    
#&gt; (Intercept)     -0.172900   0.077561  -2.229 0.026389 *  
#&gt; Parental_stress  0.004706   0.001201   3.919 0.000105 ***
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
#&gt; 
#&gt; Residual standard error: 0.3239 on 377 degrees of freedom
#&gt; Multiple R-squared:  0.03915,    Adjusted R-squared:  0.0366 
#&gt; F-statistic: 15.36 on 1 and 377 DF,  p-value: 0.0001054</code></pre>
</div>
</div>
</section>
<section id="another-example-teddy-child-4" class="slide level2">
<h2>Another example, <strong>Teddy Child</strong></h2>
<p>Let’s add the fitted line to our plot:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-12-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="another-example-teddy-child-5" class="slide level2">
<h2>Another example, <strong>Teddy Child</strong></h2>
<p>… and check the residuals, pretty bad right?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-13-1.svg" class="quarto-figure quarto-figure-center" width="960" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="another-example-teddy-child-6" class="slide level2">
<h2>Another example, <strong>Teddy Child</strong></h2>
<p>As for the exam example, we could compute a sort of contingency table despite the <code>Parental_stress</code> is a numerical variable by creating some discrete categories (just for exploratory analysis):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(teddy<span class="sc">$</span>Depression_pp, teddy<span class="sc">$</span>Parental_stress_c) <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      
#&gt;       &lt; 40 40-60 60-80 80-100 &gt; 100
#&gt;   No     0   164   136     26     6
#&gt;   Yes    0    15    21      7     4</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(teddy<span class="sc">$</span>Depression_pp, teddy<span class="sc">$</span>Parental_stress_c) <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">prop.table</span>(<span class="at">margin =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      
#&gt;       &lt; 40 40-60 60-80 80-100 &gt; 100
#&gt;   No        0.92  0.87   0.79  0.60
#&gt;   Yes       0.08  0.13   0.21  0.40</code></pre>
</div>
</div>
</section>
<section id="another-example-teddy-child-7" class="slide level2">
<h2>Another example, <strong>Teddy Child</strong></h2>
<p>Ideally, we could compute the increase in the odds of having the post-partum depression as the parental stress increase. In fact, as we are going to see, the Binomial GLM is able to estimate the non-linear increase in the probability.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-17-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="binomial-glm" class="slide level2">
<h2>Binomial GLM</h2>
<ul>
<li class="fragment">The <strong>random component</strong> of a Binomial GLM the binomial distribution with parameter <span class="math inline">\(p\)</span></li>
<li class="fragment">The <strong>systematic component</strong> is a linear combination of predictors and coefficients <span class="math inline">\(\boldsymbol{\beta X}\)</span></li>
<li class="fragment">The <strong>link function</strong> is a function that map probabilities into the <span class="math inline">\([-\infty, +\infty]\)</span> range.</li>
</ul>
</section>
<section id="logit-link" class="slide level2">
<h2>Logit Link</h2>
<p>The <strong>logit</strong> link is the most common link function when using a binomial GLM:</p>
<p><span class="math display">\[
log \left(\frac{p_i}{1 - p_i}\right) = \beta_0 + \beta_1x_{i1} + \beta_2x_{i2} + \cdots + \beta_px_{ip}
\]</span></p>
<p>The inverse of the <strong>logit</strong> maps again the probability into the <span class="math inline">\([0, 1]\)</span> range:</p>
<p><span class="math display">\[
p = \frac{e^{\beta_0 + \beta_1x_{i1} + \beta_2x_{i2} + \cdots + \beta_px_{ip}}}{1 + e^{\beta_0 + \beta_1x_{i1} + \beta_2x_{i2} + \cdots + \beta_px_{ip}}}
\]</span></p>
</section>
<section id="logit-link-1" class="slide level2">
<h2>Logit Link</h2>
<p>Thus with a single numerical predictor <span class="math inline">\(x\)</span> the relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(p\)</span> in non-linear on the probability scale but linear on the logit scale.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-18-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="logit-link-2" class="slide level2">
<h2>Logit Link</h2>
<p>The problem is that effects are non-linear, thus is more difficult to interpret and report model results</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-19-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-fitting-in-r" class="slide level2">
<h2>Model fitting in R</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/glm-fitting-R.png" class="quarto-figure quarto-figure-center" width="480" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="the-big-picture" class="slide level2">
<h2>The big picture…</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/big-picture.png" class="quarto-figure quarto-figure-center" width="388" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-fitting-in-r-1" class="slide level2">
<h2>Model fitting in R</h2>
<p>We can model the contingency table presented before. We put data in <strong>binary form</strong>:</p>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;     tv_shows
#&gt; exam  0  1
#&gt;    0 35 22
#&gt;    1 15 28</code></pre>
</div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 9 × 2
#&gt;   tv_shows exam 
#&gt;   &lt;chr&gt;    &lt;chr&gt;
#&gt; 1 1        0    
#&gt; 2 1        1    
#&gt; 3 1        1    
#&gt; 4 1        1    
#&gt; 5 ...      ...  
#&gt; 6 0        0    
#&gt; 7 0        1    
#&gt; 8 0        0    
#&gt; 9 0        0</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="intercept-only-model" class="slide level2">
<h2>Intercept only model</h2>
<p>Let’s start from the simplest model (often called null model) where there are no predictors:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(exam <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; glm(formula = exam ~ 1, family = binomial(link = &quot;logit&quot;), data = dat)
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error z value Pr(&gt;|z|)
#&gt; (Intercept)  -0.2819     0.2020  -1.395    0.163
#&gt; 
#&gt; (Dispersion parameter for binomial family taken to be 1)
#&gt; 
#&gt;     Null deviance: 136.66  on 99  degrees of freedom
#&gt; Residual deviance: 136.66  on 99  degrees of freedom
#&gt; AIC: 138.66
#&gt; 
#&gt; Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</section>
<section id="intercept-only-model-1" class="slide level2">
<h2>Intercept only model</h2>
<p>When fitting an intercept-only model, the parameter is the average value of the <code>y</code> variable:</p>
<p><span class="math display">\[\begin{align*}
\log(\frac{p}{1 - p}) = \beta_0 \\
p = \frac{e^{\beta_0}}{1 + e^{\beta_0}}
\end{align*}\]</span></p>
</section>
<section id="intercept-only-model-2" class="slide level2">
<h2>Intercept only model</h2>
<p>In R, the <span class="math inline">\(logit(p)\)</span> is computed using <code>qlogis()</code> that is the <code>q</code> + <code>logis</code> combination of functions to work with probability distributions. The <span class="math inline">\(logit^{-1}\)</span> thus the inverse of the logit function is <code>plogis()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># average y on the respo nse scale</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dat<span class="sc">$</span>exam)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.43</code></pre>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="st">&quot;logit&quot;</span> <span class="ot">=</span> <span class="fu">coef</span>(fit0)[<span class="dv">1</span>],</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;inv-logit&quot;</span> <span class="ot">=</span> <span class="fu">plogis</span>(<span class="fu">coef</span>(fit0)[<span class="dv">1</span>])</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;     logit.(Intercept) inv-logit.(Intercept) 
#&gt;            -0.2818512             0.4300000</code></pre>
</div>
</div>
</section>
<section id="link-function-tips" class="slide level2">
<h2>Link function (TIPS)</h2>
<p>If you are not sure about how to transform using the link function you can directly access the <code>family()</code> object in R that contains the appropriate link function and the corresponding inverse.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>bin <span class="ot">&lt;-</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>bin<span class="sc">$</span><span class="fu">linkfun</span>() <span class="co"># the same as qlogis</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>bin<span class="sc">$</span><span class="fu">linkinv</span>() <span class="co"># the same as plogis</span></span></code></pre></div>
</div>
</section>
<section id="model-with-x" class="slide level2">
<h2>Model with <span class="math inline">\(X\)</span></h2>
<p>Now we can add the <code>tv_shows</code> predictor. Now the model has two coefficients. Given that the <code>tv_shows</code> is a binary variable, the intercept is the average <code>y</code> when <code>tv_shows</code> is 0, and the <code>tv_shows</code> coefficient is the increase in <code>y</code> for a unit increase in <code>tv_shows</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(exam <span class="sc">~</span> tv_shows, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; glm(formula = exam ~ tv_shows, family = binomial(link = &quot;logit&quot;), 
#&gt;     data = dat)
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error z value Pr(&gt;|z|)   
#&gt; (Intercept)  -0.8473     0.3086  -2.746  0.00604 **
#&gt; tv_shows      1.0885     0.4200   2.592  0.00956 **
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
#&gt; 
#&gt; (Dispersion parameter for binomial family taken to be 1)
#&gt; 
#&gt;     Null deviance: 136.66  on 99  degrees of freedom
#&gt; Residual deviance: 129.68  on 98  degrees of freedom
#&gt; AIC: 133.68
#&gt; 
#&gt; Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</section>
<section id="model-with-x-1" class="slide level2">
<h2>Model with <span class="math inline">\(X\)</span></h2>
<p>Thinking about our data, the <code>(Intercept)</code> is the probability of passing the exam without watching tv-shows. The <code>tv_shows</code> (should be) the difference in the probability of passing the exam between people who watched or did not watched tv-shows, BUT:</p>
<ul>
<li class="fragment">we are on the logit scale. Thus we are modelling <strong>log(odds)</strong> and not probabilities</li>
<li class="fragment">a difference on the <strong>log</strong> scale is a ratio on the raw scale. Thus taking the exponential of <code>tv_shows</code> we obtain the ratio of odds of passing the exam watching vs non-watching tv-shows. Do you remember something?</li>
</ul>
</section>
<section id="model-with-x-2" class="slide level2">
<h2>Model with <span class="math inline">\(X\)</span></h2>
<p>The <code>tv_shows</code> is exactly the Odds Ratio that we calculated on the contingency table:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb32"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from model coefficients</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(fit)[<span class="st">&quot;tv_shows&quot;</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; tv_shows 
#&gt; 2.969697</code></pre>
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from the contingency table</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">odds_ratio</span>(<span class="fu">mean</span>(dat<span class="sc">$</span>exam[dat<span class="sc">$</span>tv_shows <span class="sc">==</span> <span class="dv">1</span>]),</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">mean</span>(dat<span class="sc">$</span>exam[dat<span class="sc">$</span>tv_shows <span class="sc">==</span> <span class="dv">0</span>]))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 2.969697</code></pre>
</div>
</div>
</section>
<section>
<section id="parameter-intepretation" class="title-slide slide level1 section">
<h1 class="section">Parameter Intepretation</h1>

</section>
<section id="model-intepretation" class="slide level2">
<h2>Model Intepretation</h2>
<p>Given the non-linearity and the link function, parameter intepretation is not easy for GLMs. In the case of the Binomial GLM we will see:</p>
<ul>
<li class="fragment">interpreting model coefficients on the linear and logit scale</li>
<li class="fragment">odds ratio (already introduced)</li>
<li class="fragment">the divide by 4 rule <span class="citation" data-cites="Gelman2020-tg Gelman2006-pc">(<a href="#/ref-Gelman2020-tg" role="doc-biblioref">Gelman et al., 2020</a>; <a href="#/ref-Gelman2006-pc" role="doc-biblioref">Gelman &amp; Hill, 2006</a>)</span></li>
<li class="fragment">marginal effects</li>
<li class="fragment">predicted probabilities</li>
</ul>
<div class="fragment">
<p>Some nice resources:</p>
<ul>
<li class="fragment">(https://www.polyu.edu.hk/cbs/sjpolit/logisticregression.html)[https://www.polyu.edu.hk/cbs/sjpolit/logisticregression.html#:~:text=The%20divide%2Dby%2D4%20rule,estimate%20of%20its%20marginal%20effect.]</li>
</ul>
</div>
</section>
<section id="marginaleffects-package" class="slide level2">
<h2><code>marginaleffects</code> package</h2>
<p>The <code>marginaleffects</code> <a href="https://marginaleffects.com/">package</a> provide a very complete and comprehensive framework to compute marginal effects for several models. You can have a very detailed overview of the theory and the functions reading:</p>
<ul>
<li class="fragment">The main paper by <span class="citation" data-cites="Arel-Bundock2024-zl">Arel-Bundock et al. (<a href="#/ref-Arel-Bundock2024-zl" role="doc-biblioref">2024</a>)</span></li>
<li class="fragment"><a href="https://www.youtube.com/watch?v=ANDC_kkAjeM">https://www.youtube.com/watch?v=ANDC_kkAjeM</a></li>
</ul>
</section>
<section id="marginaleffects-package-1" class="slide level2">
<h2><code>marginaleffects</code> package</h2>
<p><span class="citation" data-cites="Arel-Bundock2024-zl">Arel-Bundock et al. (<a href="#/ref-Arel-Bundock2024-zl" role="doc-biblioref">2024</a>)</span> provided an overview about intepreting effects from a fitted model, these are the main elements:</p>
<ol type="1">
<li class="fragment"><strong>Quantity</strong>: What is the quantity of interest? Do we want to report a prediction or a function of predictions (average, difference, ratio, derivative, etc.)?
<ul>
<li class="fragment">predictions</li>
<li class="fragment">comparisons (e.g., contrasts)</li>
<li class="fragment">slopes (i.e., derivatives)</li>
</ul></li>
<li class="fragment"><strong>Grid</strong>: What predictor values are we interested in? Do we want to report estimates for the units in our dataset, or for hypothetical or representative individuals?</li>
<li class="fragment"><strong>Aggregation</strong>: Do we report estimates for every observation in the grid or a global summary?</li>
<li class="fragment"><strong>Uncertainty</strong>: How do we quantify uncertainty about our estimates?</li>
<li class="fragment"><strong>Test</strong>: Which (non-)linear hypothesis or equivalence tests do we conduct?</li>
</ol>
<div class="fragment">
<p>We will not see everything, but I strongly suggest you to read the paper and try the package!</p>
</div>
</section>
<section id="marginaleffects-vs-emmeans" class="slide level2">
<h2><code>marginaleffects</code> vs <code>emmeans</code></h2>
<p><code>emmeans</code> is another very popular package for computing “<strong>e</strong>stimated <strong>m</strong>arginal <strong>means</strong>”. They provide similar functionalities but <code>emmeans</code> is used more for balanced dataset usually from experimental research (e.g., balanced factorial designs) while <code>marginaleffects</code> is used more in observational research using more complex models especially with numerical variables.</p>
</section>
<section id="intepreting-model-coefficients" class="slide level2">
<h2>Intepreting model coefficients</h2>
<p>Models coefficients are interpreted in the same way as standard regression models. The big difference concerns:</p>
<ul>
<li class="fragment">numerical predictors</li>
<li class="fragment">categorical predictors</li>
</ul>
<div class="fragment">
<p>Using <strong>contrast coding</strong> and <strong>centering/standardizing</strong> we can make model coefficients easier to intepret.</p>
</div>
</section>
<section id="categorical-predictors" class="slide level2">
<h2>Categorical predictors</h2>
<p>We use a categorical predictor with <span class="math inline">\(p\)</span> levels, the model will estimate <span class="math inline">\(p - 1\)</span> parameters. The interpretation of these parameters is controlled by the contrast coding. In R the default is the treatment coding (or dummy coding). Essentially R create <span class="math inline">\(p - 1\)</span> dummy variables (0 and 1) where 0 is the reference level (usually the first category) and 1 is the current level. We can see the coding scheme using the <code>model.matrix()</code> function that return the <span class="math inline">\(\boldsymbol{X}\)</span> matrix:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 9 × 2
#&gt;   X.Intercept. tv_shows
#&gt;   &lt;chr&gt;        &lt;chr&gt;   
#&gt; 1 1            1       
#&gt; 2 1            1       
#&gt; 3 1            1       
#&gt; 4 1            1       
#&gt; 5 ...          ...     
#&gt; 6 1            0       
#&gt; 7 1            0       
#&gt; 8 1            0       
#&gt; 9 1            0</code></pre>
</div>
</div>
</section>
<section id="categorical-predictors-1" class="slide level2">
<h2>Categorical predictors</h2>
<p>In the simple case of the <code>exam</code> dataset, the intercept (<span class="math inline">\(\beta_0\)</span>) is the reference level (default to 0 because is the first) and <span class="math inline">\(\beta_0\)</span> is the difference between the actual level and the reference level. If we change the order of the levels we could change the intercept value while <span class="math inline">\(\beta_1\)</span> will be the same. As an example we could use the so-called sum to zero coding where instead of assigning 0 and 1 we use different values. For example assigning -0.5 and 0.5 will make the intercept the grand-mean:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb37"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>tv_shows0 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(dat<span class="sc">$</span>tv_shows <span class="sc">==</span> <span class="dv">0</span>, <span class="sc">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(exam <span class="sc">~</span> tv_shows0, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="co"># grand mean</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">c</span>(<span class="fu">mean</span>(dat<span class="sc">$</span>exam[dat<span class="sc">$</span>tv_shows <span class="sc">==</span> <span class="dv">1</span>]), <span class="fu">mean</span>(dat<span class="sc">$</span>exam[dat<span class="sc">$</span>tv_shows <span class="sc">==</span> <span class="dv">0</span>])))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.43</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># intercept</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(<span class="fu">coef</span>(fit)[<span class="dv">1</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; (Intercept) 
#&gt;   0.4248077</code></pre>
</div>
</div>
</section>
<section id="categorical-predictors-2" class="slide level2">
<h2>Categorical predictors</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-31-1.svg" class="quarto-figure quarto-figure-center" width="960" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="numerical-predictors" class="slide level2">
<h2>Numerical predictors</h2>
<p>With numerical predictors the idea is the same as categorical predictors. In fact, categorical predictors are converted into numbers (i.e., 0 and 1 or -0.5 and 0.5). The only caveat is that the effects are linear only the <strong>logit</strong> scale. Thus <span class="math inline">\(\beta_1\)</span> is interpreted in the same way as standard linear models only on the link-function scale. For the <strong>binomial</strong></p>
<p>GLM the <span class="math inline">\(\beta_1\)</span> is the increase in the <span class="math inline">\(log(odds(p))\)</span> for a unit-increase in the <span class="math inline">\(x\)</span>. In the response (probability) scale, the <span class="math inline">\(\beta_1\)</span> is the multiplicative increase in the odds of <span class="math inline">\(y = 1\)</span> for a unit increase in the predictor.</p>
</section>
<section id="numerical-predictors-1" class="slide level2">
<h2>Numerical predictors</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-32-1.svg" class="quarto-figure quarto-figure-center" style="width:50.0%" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="numerical-predictors-2" class="slide level2">
<h2>Numerical predictors</h2>
<p>With numerical predictors we could mean-center and or standardize the predictors. With centering (similarly to the categorical example) we change the interpretation of the intercept. Standardizing is helpful to have more meaningful <span class="math inline">\(\beta\)</span> values. The <span class="math inline">\(\beta_i\)</span> of a centered predictor is the increase in <span class="math inline">\(y\)</span> for a increase in one standard deviation of <span class="math inline">\(x\)</span>.</p>
<p><span class="math display">\[
x_{cen} = x_i - \hat x
\]</span></p>
<p><span class="math display">\[
x_{z} = \frac{x_i - \hat x}{\sigma_x}
\]</span></p>
</section>
<section id="numerical-predictors-3" class="slide level2">
<h2>Numerical predictors</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-33-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="numerical-predictors-4" class="slide level2">
<h2>Numerical predictors</h2>
<p>Let’s return to our teddy child example and fitting the proper model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb41"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>fit_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(Depression_pp01 <span class="sc">~</span> Parental_stress, <span class="at">data =</span> teddy, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_glm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; glm(formula = Depression_pp01 ~ Parental_stress, family = binomial(link = &quot;logit&quot;), 
#&gt;     data = teddy)
#&gt; 
#&gt; Coefficients:
#&gt;                  Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; (Intercept)     -4.323906   0.690689  -6.260 3.84e-10 ***
#&gt; Parental_stress  0.036015   0.009838   3.661 0.000251 ***
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
#&gt; 
#&gt; (Dispersion parameter for binomial family taken to be 1)
#&gt; 
#&gt;     Null deviance: 284.13  on 378  degrees of freedom
#&gt; Residual deviance: 271.23  on 377  degrees of freedom
#&gt; AIC: 275.23
#&gt; 
#&gt; Number of Fisher Scoring iterations: 5</code></pre>
</div>
</div>
</section>
<section id="numerical-predictors-5" class="slide level2">
<h2>Numerical predictors</h2>
<p>The <code>(Intercept)</code> (<span class="math inline">\(\beta_0\)</span>) is the probability of having post-partum depression for a mother with parental stress zero (maybe better centering?)</p>
<p><span class="math display">\[
p(yes|x = 0) = g^{-1}(\beta_0)
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb43"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(<span class="fu">coef</span>(fit_glm)[<span class="st">&quot;(Intercept)&quot;</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; (Intercept) 
#&gt;  0.01307482</code></pre>
</div>
</div>
</section>
<section id="numerical-predictors-6" class="slide level2">
<h2>Numerical predictors</h2>
<p>The <code>Parental_stress</code> (<span class="math inline">\(\beta_1\)</span>) is the increase in the <span class="math inline">\(log(odds)\)</span> of having the post-partum depression for a unit increase in the parental stress index. If we take the exponential of <span class="math inline">\(\beta_1\)</span> we obtain the increase in the <span class="math inline">\(odds\)</span> of having post-partum depression for a unit increase in parental stress index.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb45"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(fit_glm)[<span class="st">&quot;Parental_stress&quot;</span>])</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Parental_stress 
#&gt;        1.036671</code></pre>
</div>
</div>
</section>
<section id="numerical-predictors-7" class="slide level2">
<h2>Numerical predictors</h2>
<p>The problem is that, as shown before, the effects are non-linear on the probability scale while are linear on the logit scale. On the logit scale, all differences are constant:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb47"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>), <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">51</span>), <span class="fu">c</span>(<span class="dv">70</span>, <span class="dv">71</span>))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">lapply</span>(pr, <span class="cf">function</span>(x) {</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(fit_glm, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">Parental_stress =</span> x))</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># notice that the difference is exactly the Parental_stress parameter</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(predictions, diff)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;         2         2         2 
#&gt; 0.0360147 0.0360147 0.0360147</code></pre>
</div>
</div>
</section>
<section id="numerical-predictors-8" class="slide level2">
<h2>Numerical predictors</h2>
<p>While on the probability scale, the differences are not the same. This is problematic when interpreting the results of a Binomial GLM with a numerical predictor.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>(predictions <span class="ot">&lt;-</span> <span class="fu">lapply</span>(predictions, plogis))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [[1]]
#&gt;          1          2 
#&gt; 0.01863764 0.01930790 
#&gt; 
#&gt; [[2]]
#&gt;          1          2 
#&gt; 0.07424969 0.07676350 
#&gt; 
#&gt; [[3]]
#&gt;         1         2 
#&gt; 0.1415012 0.1459330</code></pre>
</div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(predictions, diff)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            2            2            2 
#&gt; 0.0006702661 0.0025138036 0.0044317558</code></pre>
</div>
</div>
</section>
<section id="predicted-probabilities" class="slide level2">
<h2>Predicted probabilities</h2>
<div class="fragment">
<p>In a similar way we can use the inverse logit function to find the predicted probability specific values of <span class="math inline">\(x\)</span>. For example, the difference between <span class="math inline">\(p(y = 1|x = 2.5) - p(y = 1|x = 5)\)</span> can be calculated using the model equation:</p>
<ul>
<li class="fragment"><span class="math inline">\(p(y = 1|x = 2.5) = \frac{e^{\beta_0 + \beta_1 2.5}}{1 + e^{\beta_0 + \beta_1 2.5}}\)</span></li>
<li class="fragment"><span class="math inline">\(p(y = 1|x = 5) = \frac{e^{\beta_0 + \beta_1 5}}{1 + e^{\beta_0 + \beta_1 5}}\)</span></li>
<li class="fragment"><span class="math inline">\(p(y = 1|x = 5) - p(y = 1|x = 2.5)\)</span></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb53"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(fit)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plogis</span>(coefs[<span class="dv">1</span>] <span class="sc">+</span> coefs[<span class="dv">2</span>]<span class="sc">*</span><span class="dv">5</span>) <span class="sc">-</span> <span class="fu">plogis</span>(coefs[<span class="dv">1</span>] <span class="sc">+</span> coefs[<span class="dv">2</span>]<span class="sc">*</span><span class="fl">2.5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  (Intercept) 
#&gt; 4.642617e-10</code></pre>
</div>
</div>
</div>
</section>
<section id="predicted-probabilities-1" class="slide level2">
<h2>Predicted probabilities</h2>
<p>In R we can use directly the <code>predict()</code> function with the argument <code>type = "response"</code> to return the predicted probabilities instead of the logits:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb55"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="fl">2.5</span>, <span class="dv">5</span>)), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>preds</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 1 2 
#&gt; 1 1</code></pre>
</div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>preds[<span class="dv">2</span>] <span class="sc">-</span> preds[<span class="dv">1</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;            2 
#&gt; 4.642615e-10</code></pre>
</div>
</div>
</section>
<section id="marginal-effects" class="slide level2">
<h2>Marginal effects</h2>
<p>A marginal effect measures the association between a change in a predictor (<span class="math inline">\(x\)</span>), and a change in the response <span class="math inline">\(y\)</span>.</p>
<p>The slope can be evaluated for any level of <span class="math inline">\(x\)</span>. In fact, the divide-by-4 rule is the maximal slope evaluated at a specific <span class="math inline">\(x\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-41-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="marginal-effects-1" class="slide level2">
<h2>Marginal effects</h2>
<p>The divide-by-4 rule is the maximal marginal effect. The average marginal effects is the average of all slopes. This can be easily done with the <code>marginaleffects</code> package:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb59"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(marginaleffects)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># all marginal effects</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">slopes</span>(fit)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  Estimate Std. Error     z Pr(&gt;|z|)    S   2.5 % 97.5 %</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    1.8970     0.3614 5.249  &lt; 0.001 22.6  1.1887 2.6053</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.0303     0.0330 0.918  0.35857  1.5 -0.0343 0.0949</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2.2041     0.4176 5.278  &lt; 0.001 22.9  1.3856 3.0227</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2.3011     0.4014 5.732  &lt; 0.001 26.6  1.5143 3.0879</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.0776     0.0693 1.119  0.26293  1.9 -0.0583 0.2135</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; --- 90 rows omitted. See ?print.marginaleffects ---</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.0187     0.0223 0.842  0.39982  1.3 -0.0249 0.0624</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.2091     0.1422 1.471  0.14137  2.8 -0.0696 0.4878</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.0130     0.0164 0.792  0.42859  1.2 -0.0191 0.0451</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    2.2424     0.3895 5.758  &lt; 0.001 26.8  1.4791 3.0058</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;    0.8147     0.2690 3.028  0.00246  8.7  0.2874 1.3420</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Term: x</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Type: response</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Comparison: dY/dX</span></span></code></pre></div>
</div>
</section>
<section id="marginal-effects-2" class="slide level2">
<h2>Marginal effects</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb60"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># marginal effects when x = 5</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slopes</span>(fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">5</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Estimate Std. Error  z Pr(&gt;|z|)  S 2.5 % 97.5 % x
#&gt;         0         NA NA       NA NA    NA     NA 5
#&gt; 
#&gt; Term: x
#&gt; Type: response
#&gt; Comparison: dY/dX</code></pre>
</div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># average marginal effect</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">avg_slopes</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Estimate Std. Error    z Pr(&gt;|z|)     S 2.5 % 97.5 %
#&gt;      1.19     0.0629 18.9   &lt;0.001 261.6  1.06   1.31
#&gt; 
#&gt; Term: x
#&gt; Type: response
#&gt; Comparison: dY/dX</code></pre>
</div>
</div>
</section>
<section id="marginal-effects-3" class="slide level2">
<h2>Marginal effects</h2>
<p>With multiple variables, marginal effects are also useful to see the effect of one predictor fixing the level of others. Let’s simulate a model with two predictors:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb64"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_design</span>(<span class="dv">100</span>, <span class="at">nx =</span> <span class="fu">list</span>(<span class="at">x1 =</span> <span class="fu">runif</span>(<span class="dv">100</span>), <span class="at">x2 =</span> <span class="fu">runif</span>(<span class="dv">100</span>)))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_data</span>(dat, <span class="fu">plogis</span>(<span class="fu">qlogis</span>(<span class="fl">0.001</span>) <span class="sc">+</span> <span class="dv">5</span> <span class="sc">*</span> x1 <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x2), <span class="at">model =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ggeffect</span>(fit)<span class="sc">$</span>x1) <span class="sc">|</span> <span class="fu">plot</span>(<span class="fu">ggeffect</span>(fit)<span class="sc">$</span>x2)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-44-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="marginal-effects-4" class="slide level2">
<h2>Marginal effects</h2>
<p>We can see the marginal effects (each, average or marginal) for the <span class="math inline">\(x1\)</span> while fixing <span class="math inline">\(x2\)</span> to the mean:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb65"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">slopes</span>(fit, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span> dat<span class="sc">$</span>x1, <span class="at">x2 =</span> <span class="fu">mean</span>(dat<span class="sc">$</span>x2)))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt;  Term Estimate Std. Error     z Pr(&gt;|z|)   S   2.5 % 97.5 %     x1    x2
#&gt;    x1   0.0220     0.0174 1.266    0.205 2.3 -0.0120  0.056 0.0285 0.504
#&gt;    x1   0.0552     0.1060 0.520    0.603 0.7 -0.1526  0.263 0.7780 0.504
#&gt;    x1   0.0652     0.1396 0.467    0.640 0.6 -0.2083  0.339 0.9199 0.504
#&gt;    x1   0.0675     0.1474 0.458    0.647 0.6 -0.2214  0.356 0.9493 0.504
#&gt;    x1   0.0479     0.0830 0.577    0.564 0.8 -0.1148  0.211 0.6593 0.504
#&gt; --- 190 rows omitted. See ?print.marginaleffects ---
#&gt;    x2   0.0522     0.0510 1.023    0.306 1.7 -0.0478  0.152 0.1950 0.504
#&gt;    x2   0.0683     0.0510 1.339    0.181 2.5 -0.0317  0.168 0.4131 0.504
#&gt;    x2   0.0565     0.0507 1.115    0.265 1.9 -0.0428  0.156 0.2594 0.504
#&gt;    x2   0.1376     0.1329 1.035    0.301 1.7 -0.1229  0.398 0.9986 0.504
#&gt;    x2   0.0834     0.0569 1.466    0.143 2.8 -0.0281  0.195 0.5758 0.504
#&gt; Type: response
#&gt; Comparison: dY/dX</code></pre>
</div>
</div>
</section>
<section id="divide-by-4-rule" class="slide level2">
<h2>Divide by 4 rule</h2>
<p>The <strong>divide by 4 rule</strong> is a very easy way to evaluate the effect of a continuous predictor.</p>
<p>Given the non-linearity, the derivative of the logistic function (i.e., the slope) is maximal for probabilities around ~<span class="math inline">\(0.5\)</span>.</p>
<p>In fact, <span class="math inline">\(\beta_i p (1 - p)\)</span> is maximized when <span class="math inline">\(p = 0.5\)</span> turning into <span class="math inline">\(\beta_i 0.25\)</span> (i.e., dividing by 4).</p>
<p>Dividing <span class="math inline">\(\beta/4\)</span> we obtain the maximal slope thus the maximal difference in probability.</p>
</section>
<section id="divide-by-4-rule-1" class="slide level2">
<h2>Divide by 4 rule</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-46-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="misleading-divide-by-4-rule" class="slide level2">
<h2>Misleading divide by 4 rule</h2>
<p>The divide by 4 rule can be misleading where at 50% accuracy we have few or no data.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-47-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:  glm(formula = Depression_pp01 ~ Parental_stress, family = binomial(link = &quot;logit&quot;), 
#&gt;     data = teddy)
#&gt; 
#&gt; Coefficients:
#&gt;     (Intercept)  Parental_stress  
#&gt;        -4.32391          0.03601  
#&gt; 
#&gt; Degrees of Freedom: 378 Total (i.e. Null);  377 Residual
#&gt; Null Deviance:       284.1 
#&gt; Residual Deviance: 271.2     AIC: 275.2</code></pre>
</div>
</div>
</section>
<section id="misleading-divide-by-4-rule-1" class="slide level2">
<h2>Misleading divide by 4 rule</h2>
<p>For example, in the <code>TeddyChild</code> dataset, the relationship between post-partum depression and parental stress cover a wide range but there are few observation around <span class="math inline">\(y = 50\%\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb68"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(fit_glm))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-48-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="inverse-estimation" class="slide level2">
<h2>Inverse estimation<a href="#/fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></h2>
<p>Sometimes it is useful to do what is called <strong>inverse estimation</strong>, thus predicting the <span class="math inline">\(x\)</span> level associated with a certain <span class="math inline">\(y\)</span>. In this case the <span class="math inline">\(x\)</span> producing a certain <span class="math inline">\(p\)</span> of response.</p>
<p>Sometimes this is called <strong>median effective dose</strong> when finding the <span class="math inline">\(x\)</span> level producing <span class="math inline">\(50\%\)</span> of correct responses.</p>
<p>We can use the <code>MASS::dose.p()</code> function:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb69"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">dose.p</span>(fit, <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.8</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;               Dose        SE
#&gt; p = 0.25: 4.673415 0.3921583
#&gt; p = 0.50: 6.016556 0.3553563
#&gt; p = 0.80: 7.711411 0.5399785</code></pre>
</div>
</div>
<p>Clearly, the range of the predictor need to be meaningful. Predicting the probability of post partum depression being 0.9 is probably meaningless given the bounded nature of the predictor variable.</p>
</section>
<section id="inverse-estimation-1" class="slide level2">
<h2>Inverse estimation</h2>
<p>Still using the <code>TeddyChild</code> dataset, an application could be to estimate the level of parental stress required to have a certain probability of post-partum depression. For example:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb71"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">dose.p</span>(fit_glm, <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;              Dose       SE
#&gt; p = 0.5: 120.0595 14.80923
#&gt; p = 0.7: 143.5859 21.03040
#&gt; p = 0.8: 158.5519 25.04193</code></pre>
</div>
</div>
<p>Thus with a</p>
</section>
<section id="inverse-estimation-and-psychophysics" class="slide level2">
<h2>Inverse estimation and Psychophysics</h2>
<p>In Psychophysics it is common to do the inverse estimation to estimate the detection or performance threshold. For example, estimating the <span class="math inline">\(x\)</span> level associated with a certain probability of success e.g. 50%.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb73"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">plogis</span>(x, <span class="fl">0.7</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span>), </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">xlab =</span> <span class="st">&quot;Stimulus Contrast&quot;</span>,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ylab =</span> <span class="st">&quot;Probability of Detection&quot;</span>,</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="fl">0.7</span>, <span class="at">y0 =</span> <span class="dv">0</span>, <span class="at">x1 =</span> <span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0 =</span> <span class="dv">0</span>, <span class="at">y0 =</span> <span class="fl">0.5</span>, <span class="at">x1 =</span> <span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x =</span> <span class="fl">0.7</span>, <span class="at">y =</span> <span class="fl">0.5</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-51-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="inverse-estimation-and-psychophysics-1" class="slide level2">
<h2>Inverse estimation and Psychophysics</h2>
<p>Let’s simulate and ideal observer that respond to stimuli with different contrast:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb74"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>th <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="co"># -(b0/b1)</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">8</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>slope</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="sc">-</span>th<span class="sc">*</span>b1</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>), <span class="at">each =</span> <span class="dv">20</span>)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">plogis</span>(b0 <span class="sc">+</span> b1 <span class="sc">*</span> x)</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">length</span>(x), <span class="dv">1</span>, p)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>yp <span class="ot">&lt;-</span> <span class="fu">tapply</span>(y, x, mean)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>xc <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(xc, yp, <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;Contrast&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Probability of Detection&quot;</span>)</span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">plogis</span>(x, th, slope), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col =</span> <span class="st">&quot;firebrick&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-52-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="inverse-estimation-and-psychophysics-2" class="slide level2">
<h2>Inverse estimation and Psychophysics</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb75"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; glm(formula = y ~ x, family = binomial(link = &quot;logit&quot;))
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; (Intercept)  -5.3958     0.7164  -7.532 4.98e-14 ***
#&gt; x             8.3175     1.0833   7.678 1.62e-14 ***
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
#&gt; 
#&gt; (Dispersion parameter for binomial family taken to be 1)
#&gt; 
#&gt;     Null deviance: 289.51  on 219  degrees of freedom
#&gt; Residual deviance: 148.28  on 218  degrees of freedom
#&gt; AIC: 152.28
#&gt; 
#&gt; Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
</section>
<section id="inverse-estimation-and-psychophysics-3" class="slide level2">
<h2>Inverse estimation and Psychophysics</h2>
<p>We can estimate the threshold and slope of the psychometric function using the equations from <span class="citation" data-cites="Knoblauch2012-to">Knoblauch &amp; Maloney (<a href="#/ref-Knoblauch2012-to" role="doc-biblioref">2012</a>)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb77"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span>(<span class="fu">coef</span>(fit)[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">coef</span>(fit)[<span class="dv">2</span>]) <span class="co"># threshold</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; (Intercept) 
#&gt;    0.648735</code></pre>
</div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>MASS<span class="sc">::</span><span class="fu">dose.p</span>(fit, <span class="at">p =</span> <span class="fl">0.5</span>) <span class="co"># with inverse estimation</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;              Dose         SE
#&gt; p = 0.5: 0.648735 0.02506184</code></pre>
</div>
</div>
</section>
<section id="odds-ratio-or-to-cohens-d" class="slide level2">
<h2>Odds Ratio (OR) to Cohen’s <span class="math inline">\(d\)</span></h2>
<p>The Odds Ratio can be considered an effect size measure. We can transform the OR into other effect size measure <span class="citation" data-cites="Sanchez-Meca2003-ji Borenstein2009-mo">(<a href="#/ref-Borenstein2009-mo" role="doc-biblioref">Borenstein et al., 2009</a>; <a href="#/ref-Sanchez-Meca2003-ji" role="doc-biblioref">Sánchez-Meca et al., 2003</a>)</span>.</p>
<p><span class="math display">\[
d = \log(OR) \frac{\sqrt{3}}{\pi}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb81"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in R with the effectsize package</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>or <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">logoddsratio_to_d</span>(<span class="fu">log</span>(or))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.2235446</code></pre>
</div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or </span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>effectsize<span class="sc">::</span><span class="fu">oddsratio_to_d</span>(or)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.2235446</code></pre>
</div>
</div>
</section>
<section id="odds-ratio-or-to-cohens-d-1" class="slide level2">
<h2>Odds Ratio (OR) to Cohen’s <span class="math inline">\(d\)</span></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-56-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section></section>
<section>
<section id="inference" class="title-slide slide level1 section">
<h1 class="section">Inference</h1>

</section>
<section id="wald-tests" class="slide level2">
<h2>Wald tests</h2>
<p>The basic approach when doing inference with GLM is interpreting the Wald test of each model coefficients. The Wald test is calculated as follows:</p>
<p><span class="math display">\[
z = \frac{\beta_p - \beta_0}{\sigma_{\beta_p}}
\]</span></p>
<p>Where <span class="math inline">\(\beta\)</span> is the regression coefficients, <span class="math inline">\(\beta_0\)</span> is the value under the null hypothesis (generally 0) and <span class="math inline">\(\sigma_{\beta_p}\)</span> is the standard error. P-values and confidence intervals can be calculated based on a standard normal distribution.</p>
</section>
<section id="wald-type-confidence-intervals" class="slide level2">
<h2>Wald-type confidence intervals</h2>
<p>Wald-type confidence interval (directly from model summary), where <span class="math inline">\(\Phi\)</span> is the cumulative Gaussian function <code>qnorm()</code>:</p>
<p><span class="math display">\[
95\%CI = \hat \beta \pm \Phi(\alpha/2) SE_{\beta}  
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb85"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>(summ <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">summary</span>(fit)<span class="sc">$</span>coefficients))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 4
#&gt;   Estimate Std..Error z.value Pr...z..
#&gt;      &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
#&gt; 1   -0.944      0.315   -3.00 0.00271 
#&gt; 2    1.52       0.431    3.52 0.000425</code></pre>
</div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 95% confidence interval</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>summ<span class="sc">$</span>Estimate <span class="sc">+</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.95</span>))<span class="sc">*</span>summ<span class="sc">$</span>Std..Error</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] -1.561792  2.229236</code></pre>
</div>
</div>
</section>
<section id="profile-likelihood-confidence-intervals" class="slide level2">
<h2>Profile likelihood confidence intervals</h2>
<p>The computation is a little bit different and they are not always symmetric:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb89"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># profile likelihood, different from wald type</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;                 2.5 %     97.5 %
#&gt; (Intercept) -1.595244 -0.3501169
#&gt; tv_shows     0.693377  2.3909084</code></pre>
</div>
</div>
</section>
<section id="profile-likelihood-confidence-intervals-1" class="slide level2">
<h2>Profile likelihood confidence intervals</h2>
<p>You can use the <code>plot_param()</code> function (quite overkilled):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb91"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_param</span>(fit, <span class="st">&quot;tv_shows&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-60-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="confidence-intervals" class="slide level2">
<h2>Confidence intervals</h2>
<p>When calculating confidence intervals it is important to consider the link function. In the same way as we compute the inverse logit function on the parameter value, we could revert also the confidence intervals. <strong>IMPORTANT, do not apply the inverse logit on the standard error and then compute the confidence interval</strong>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb92"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> broom<span class="sc">::</span><span class="fu">tidy</span>(fit) <span class="co"># extract parameters as dataframe</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>fits</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 5
#&gt;   term        estimate std.error statistic p.value
#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
#&gt; 1 (Intercept)   -0.490     0.291     -1.68 0.0929 
#&gt; 2 tv_shows       1.15      0.417      2.76 0.00572</code></pre>
</div>
</div>
</section>
<section id="confidence-intervals-1" class="slide level2">
<h2>Confidence intervals<a href="#/fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb94"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> fits<span class="sc">$</span>estimate[<span class="dv">2</span>]</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> fits<span class="sc">$</span>std.error[<span class="dv">2</span>]</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># correct, wald-type confidence intervals</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">b =</span> <span class="fu">exp</span>(b), <span class="at">lower =</span> <span class="fu">exp</span>(b <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>se), <span class="at">upper =</span> <span class="fu">exp</span>(b <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>se))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;        b    lower    upper 
#&gt; 3.167183 1.375115 7.294695</code></pre>
</div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correct, likelihood based confidence intervals</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">confint</span>(fit, <span class="st">&quot;tv_shows&quot;</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;    2.5 %   97.5 % 
#&gt; 1.416352 7.309771</code></pre>
</div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wrong wald type</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="at">b =</span> <span class="fu">exp</span>(b), <span class="at">lower =</span> <span class="fu">exp</span>(b) <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(se), <span class="at">upper =</span> <span class="fu">exp</span>(b) <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(se))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;         b     lower     upper 
#&gt; 3.1671827 0.1319149 6.2024504</code></pre>
</div>
</div>
</section>
<section id="confidence-intervals-2" class="slide level2">
<h2>Confidence intervals</h2>
<p>The same principle holds for predicted probabilities. First compute the intervals on the logit scale and then transform-back on the probability scale:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb100"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(tv_shows) <span class="sc">|&gt;</span> </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>() <span class="sc">|&gt;</span> </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_predict</span>(fit, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>fits<span class="sc">$</span>p <span class="ot">&lt;-</span> <span class="fu">plogis</span>(fits<span class="sc">$</span>fit)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>fits<span class="sc">$</span>lower <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="fu">with</span>(fits, fit <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>se.fit))</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>fits<span class="sc">$</span>upper <span class="ot">&lt;-</span> <span class="fu">plogis</span>(<span class="fu">with</span>(fits, fit <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>se.fit))</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>fits</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 7
#&gt;   tv_shows    fit se.fit residual.scale     p lower upper
#&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1        1  0.663  0.299              1 0.660 0.517 0.779
#&gt; 2        0 -0.490  0.291              1 0.380 0.255 0.523</code></pre>
</div>
</div>
</section>
<section id="anova" class="slide level2">
<h2>Anova</h2>
<p>With multiple predictors, especially with categorical variables with more than 2 levels, we can compute the an anova-like analysis individuating the effect of each predictor. In R we can do this using the <code>car::Anova()</code> function. Let’s simulate a model with a 2x2 interaction:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 6 × 4
#&gt;      id x1    x2        y
#&gt;   &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;int&gt;
#&gt; 1     1 a     c         1
#&gt; 2     2 a     d         0
#&gt; 3     3 b     c         0
#&gt; 4     4 b     d         0
#&gt; 5     5 a     c         0
#&gt; 6     6 a     d         0</code></pre>
</div>
</div>
</section>
<section id="anova-1" class="slide level2">
<h2>Anova</h2>
<p>We can fit the most complex model containing the two main effects and the interaction. I set the contrasts for the two factors as <code>contr.sum()/2</code> that are required for a proper analysis of factorial designs:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb103"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>fit_max <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2 <span class="sc">+</span> x1<span class="sc">:</span>x2, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>)) <span class="co"># same as x1 * x2</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_max)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; glm(formula = y ~ x1 + x2 + x1:x2, family = binomial(link = &quot;logit&quot;), 
#&gt;     data = dat)
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; (Intercept)  -1.0692     0.2321  -4.606  4.1e-06 ***
#&gt; x11           0.7520     0.4642   1.620  0.10523    
#&gt; x21           1.4452     0.4642   3.113  0.00185 ** 
#&gt; x11:x21      -0.1178     0.9284  -0.127  0.89905    
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
#&gt; 
#&gt; (Dispersion parameter for binomial family taken to be 1)
#&gt; 
#&gt;     Null deviance: 143.06  on 119  degrees of freedom
#&gt; Residual deviance: 129.31  on 116  degrees of freedom
#&gt; AIC: 137.31
#&gt; 
#&gt; Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</section>
<section id="anova-2" class="slide level2">
<h2>Anova</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb105"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">ggeffect</span>(fit_max))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; $x1</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-67-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; $x2</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-67-2.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="anova-3" class="slide level2">
<h2>Anova</h2>
<p>Then using <code>car::Anova()</code>. For each effect we have the <span class="math inline">\(\chi^2\)</span> statistics and the associated p-value. The null hypothesis is that the specific factor did not contribute in reducing the residual deviance.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb108"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(fit_max)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 3 × 3
#&gt;   `LR Chisq`    Df `Pr(&gt;Chisq)`
#&gt;        &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;
#&gt; 1     2.90       1     0.0884  
#&gt; 2    11.1        1     0.000869
#&gt; 3     0.0162     1     0.899</code></pre>
</div>
</div>
</section>
<section id="model-comparison" class="slide level2">
<h2>Model comparison</h2>
<p>The table obtained with <code>car::Anova()</code> is essentially a model comparison using the Likelihood Ratio test. This can be done using the <code>anova(...)</code> function.</p>
<p><span class="math display">\[\begin{align*}
D = 2 (log(\mathcal{L}_{full}) - log(\mathcal{L}_{reduced})) \\
D \sim \chi^2_{df_{full} - df_{reduced}}
\end{align*}\]</span></p>
</section>
<section id="model-comparison-1" class="slide level2">
<h2>Model comparison</h2>
<p>To better understanding, the <code>x2</code> effect reported in the <code>car::Anova()</code> table is a model comparison between a model with <code>y ~ x1 + x2</code> and a model without <code>x2</code>. The difference between these two model is the unique contribution of <code>x2</code> after controlling for <code>x1</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb110"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit0, fit, <span class="at">test =</span> <span class="st">&quot;LRT&quot;</span>) <span class="co"># ~ same as car::Anova(fit_max)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 5
#&gt;   `Resid. Df` `Resid. Dev`    Df Deviance `Pr(&gt;Chi)`
#&gt;         &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
#&gt; 1         118         140.    NA     NA    NA       
#&gt; 2         117         129.     1     11.1   0.000869</code></pre>
</div>
</div>
</section>
<section id="model-comparison-2" class="slide level2">
<h2>Model comparison</h2>
<p>The model comparison using <code>anova()</code> (i.e., likelihood ratio tests) is limited to nested models thus models that differs only for one term. For example:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb112"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x1, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x2, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span></code></pre></div>
</div>
<p><code>fit1</code> and <code>fit2</code> are non-nested because we have the same number of predictors (thus degrees of freedom). <code>fit3</code> and <code>fit1</code>/<code>fit2</code> are nested because <code>fit3</code> is more complex and removing one term we can obtain the less complex models.</p>
</section>
<section id="model-comparison-3" class="slide level2">
<h2>Model comparison</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb113"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit1, fit2, <span class="at">test =</span> <span class="st">&quot;LRT&quot;</span>) <span class="co"># do not works properly</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 5
#&gt;   `Resid. Df` `Resid. Dev`    Df Deviance `Pr(&gt;Chi)`
#&gt;         &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
#&gt; 1         118         140.    NA    NA            NA
#&gt; 2         118         132.     0     8.18         NA</code></pre>
</div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit1, fit3, <span class="at">test =</span> <span class="st">&quot;LRT&quot;</span>) <span class="co"># same anova(fit2, fit3)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 5
#&gt;   `Resid. Df` `Resid. Dev`    Df Deviance `Pr(&gt;Chi)`
#&gt;         &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
#&gt; 1         118         140.    NA     NA    NA       
#&gt; 2         117         129.     1     11.1   0.000869</code></pre>
</div>
</div>
</section>
<section id="information-criteria" class="slide level2">
<h2>Information Criteria</h2>
<p>As for standard linear models I can use the Akaike Information Criteria (AIC) or the Bayesian Information Criteria (BIC) to compare non-nested models. The downside is not having a properly hypothesis testing setup.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb117"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">BIC</span>(fit1, fit2, fit3)) <span class="sc">|&gt;</span> </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(BIC)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 3 × 2
#&gt;      df   BIC
#&gt;   &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     2  142.
#&gt; 2     3  144.
#&gt; 3     2  150.</code></pre>
</div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">AIC</span>(fit1, fit2, fit3)) <span class="sc">|&gt;</span> </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(AIC)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 3 × 2
#&gt;      df   AIC
#&gt;   &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1     3  135.
#&gt; 2     2  136.
#&gt; 3     2  144.</code></pre>
</div>
</div>
</section>
<section id="marginal-means" class="slide level2">
<h2>Marginal Means</h2>
<p>For post-hoc contrasts you can use the <code>emmeans</code> package both for numerical but especially categorical predictors. Let’s simulate a 2x2 interaction:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb121"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_design</span>(<span class="dv">100</span>, <span class="at">cx =</span> <span class="fu">list</span>(<span class="at">x1 =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), <span class="at">x2 =</span> <span class="fu">c</span>(<span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>)), <span class="at">contrasts =</span> contr.sum2)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_data</span>(dat, <span class="fu">plogis</span>(<span class="fu">qlogis</span>(<span class="fl">0.25</span>) <span class="sc">+</span> <span class="dv">0</span> <span class="sc">*</span> x1_c <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x2_c <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x1_c <span class="sc">*</span> x2_c))</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x1 <span class="sc">*</span> x2, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; glm(formula = y ~ x1 * x2, family = binomial(link = &quot;logit&quot;), 
#&gt;     data = dat)
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; (Intercept)  -1.2944     0.1775  -7.290 3.09e-13 ***
#&gt; x11          -0.3551     0.3551  -1.000    0.317    
#&gt; x21           2.5456     0.3551   7.169 7.56e-13 ***
#&gt; x11:x21       2.9255     0.7102   4.119 3.80e-05 ***
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
#&gt; 
#&gt; (Dispersion parameter for binomial family taken to be 1)
#&gt; 
#&gt;     Null deviance: 485.25  on 399  degrees of freedom
#&gt; Residual deviance: 377.36  on 396  degrees of freedom
#&gt; AIC: 385.36
#&gt; 
#&gt; Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
</section>
<section id="marginal-means-1" class="slide level2">
<h2>Marginal Means</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb123"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ggeffects<span class="sc">::</span><span class="fu">ggeffect</span>(fit, <span class="at">terms =</span> <span class="fu">c</span>(<span class="st">&quot;x1&quot;</span>, <span class="st">&quot;x2&quot;</span>)))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-74-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="marginal-means-2" class="slide level2">
<h2>Marginal Means</h2>
<p><code>emmeans</code> is a very powerful and complicate package (<a href="https://cran.r-project.org/web/packages/emmeans/index.html">documentation</a>). Firstly we can estimate the marginal means of the conditions:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb124"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(fit, <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  x1 x2 emmean    SE  df asymp.LCL asymp.UCL
#&gt;  a  c   0.532 0.207 Inf     0.126     0.938
#&gt;  b  c  -0.575 0.208 Inf    -0.984    -0.167
#&gt;  a  d  -3.476 0.586 Inf    -4.625    -2.327
#&gt;  b  d  -1.658 0.273 Inf    -2.193    -1.124
#&gt; 
#&gt; Results are given on the logit (not the response) scale. 
#&gt; Confidence level used: 0.95</code></pre>
</div>
</div>
</section>
<section id="marginal-means-3" class="slide level2">
<h2>Marginal Means</h2>
<p>We can also calculate the marginal means on the response scale:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb126"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(fit, <span class="sc">~</span> x1 <span class="sc">+</span> x2, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  x1 x2 prob     SE  df asymp.LCL asymp.UCL
#&gt;  a  c  0.63 0.0483 Inf   0.53152    0.7187
#&gt;  b  c  0.36 0.0480 Inf   0.27216    0.4583
#&gt;  a  d  0.03 0.0171 Inf   0.00971    0.0889
#&gt;  b  d  0.16 0.0367 Inf   0.10039    0.2453
#&gt; 
#&gt; Confidence level used: 0.95 
#&gt; Intervals are back-transformed from the logit scale</code></pre>
</div>
</div>
</section>
<section id="marginal-means-4" class="slide level2">
<h2>Marginal Means</h2>
<p>Crucially we can compute the contrasts (i.e., the post-hoc tests). Notice that they are computed on the link-function scale:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb128"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(fit, pairwise <span class="sc">~</span> x1 <span class="sc">|</span> x2)<span class="sc">$</span>contrasts</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x2 = c:</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast estimate    SE  df z.ratio p.value</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  a - b        1.11 0.294 Inf   3.770  0.0002</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x2 = d:</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast estimate    SE  df z.ratio p.value</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  a - b       -1.82 0.647 Inf  -2.812  0.0049</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Results are given on the log odds ratio (not the response) scale.</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(fit, pairwise <span class="sc">~</span> x1 <span class="sc">|</span> x2, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)<span class="sc">$</span>contrasts</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x2 = c:</span></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast odds.ratio    SE  df null z.ratio p.value</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  a / b         3.027 0.889 Inf    1   3.770  0.0002</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x2 = d:</span></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast odds.ratio    SE  df null z.ratio p.value</span></span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  a / b         0.162 0.105 Inf    1  -2.812  0.0049</span></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tests are performed on the log odds ratio scale</span></span></code></pre></div>
</div>
</section>
<section id="marginal-means-5" class="slide level2">
<h2>Marginal Means</h2>
<p>Notice the order of the terms to change the actual type of contrasts:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb129"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(fit, pairwise <span class="sc">~</span> x2 <span class="sc">|</span> x1)<span class="sc">$</span>contrasts</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x1 = a:</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast estimate    SE  df z.ratio p.value</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  c - d        4.01 0.622 Inf   6.447  &lt;.0001</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x1 = b:</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast estimate    SE  df z.ratio p.value</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  c - d        1.08 0.343 Inf   3.155  0.0016</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Results are given on the log odds ratio (not the response) scale.</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="fu">emmeans</span>(fit, pairwise <span class="sc">~</span> x2 <span class="sc">|</span> x1, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)<span class="sc">$</span>contrasts</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x1 = a:</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast odds.ratio    SE  df null z.ratio p.value</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  c / d         55.05 34.20 Inf    1   6.447  &lt;.0001</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; x1 = b:</span></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  contrast odds.ratio    SE  df null z.ratio p.value</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  c / d          2.95  1.01 Inf    1   3.155  0.0016</span></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Tests are performed on the log odds ratio scale</span></span></code></pre></div>
</div>
</section></section>
<section>
<section id="plotting-effects" class="title-slide slide level1 section">
<h1 class="section">Plotting effects</h1>

</section>
<section id="marginal-effects-5" class="slide level2">
<h2>Marginal effects</h2>
<p>When plotting a binomial GLM the most useful way is plotting the marginal probabilities and standard errors/confidence intervals for a given combination of predictors. Let’s make an example for:</p>
<ul>
<li class="fragment">simple GLM with 1 categorical/numerical predictor</li>
<li class="fragment">GLM with 2 numerical/categorical predictors</li>
<li class="fragment">GLM with interaction between numerical and categorical predictors</li>
</ul>
</section>
<section id="marginal-effects-6" class="slide level2">
<h2>Marginal effects</h2>
<p>A general workflow could be:</p>
<ul>
<li class="fragment">fit the model</li>
<li class="fragment">use the <code>marginaleffects</code> package or the <code>predict()</code> function</li>
<li class="fragment">calculating the confidence intervals</li>
<li class="fragment">plotting the results</li>
</ul>
<div class="fragment">
<p>Everything can be simplified using some packages to perform each step and returning a plot:</p>
<ul>
<li class="fragment"><code>allEffects()</code> from the <code>effects()</code> package (return a base R plot)</li>
<li class="fragment"><code>ggeffect()</code> from the <code>ggeffect()</code> package (return a <code>ggplot2</code> object)</li>
<li class="fragment"><code>plot_model</code> from the <code>sjPlot</code> package (similar to <code>ggeffect()</code>)</li>
</ul>
</div>
</section>
<section id="categorical-predictor" class="slide level2">
<h2>1 categorical predictor</h2>
<p>In this situation we can just plot the marginal probabilities for each level of the categorical predictor. Plotting our exam dataset:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-79-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="numerical-predictor" class="slide level2">
<h2>1 numerical predictor</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-80-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="alleffects" class="slide level2">
<h2><code>allEffects()</code></h2>
<div class="columns">
<div class="column">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-81-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-82-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="ggeffectplot_model" class="slide level2">
<h2><code>ggeffect()</code>/<code>plot_model()</code></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-83-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-coefficients" class="slide level2">
<h2>Plotting coefficients</h2>
<div class="columns">
<div class="column">
<p>Sometimes could be useful to plot the estimated sampling distribution of a coefficient. For example, we can plot the <code>tv_shows</code> effect on our example. I’ve written the <code>plot_param()</code> function that directly create a basic-plot given the model and the coefficient name. The plot highlight the null value and the 95% Wald confidence interval.</p>
</div><div class="column">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-84-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section></section>
<section>
<section id="glm---diagnostic" class="title-slide slide level1 section">
<h1 class="section">GLM - Diagnostic</h1>

</section>
<section id="glm---diagnostic-1" class="slide level2">
<h2>GLM - Diagnostic</h2>
<p>The diagnostic for GLM is similar to standard linear models. Some areas are more complicated for example residual analysis and goodness of fit. We will see:</p>
<ul>
<li class="fragment">Deviance</li>
<li class="fragment"><span class="math inline">\(R^2\)</span></li>
<li class="fragment">Residuals
<ul>
<li class="fragment">Types of residuals</li>
<li class="fragment">Residual deviance</li>
</ul></li>
<li class="fragment">Outliers and influential observations</li>
</ul>
</section>
<section id="likelihood" class="slide level2">
<h2>Likelihood</h2>
<p>The likelihood is the joint probability of the observed data viewed as a function of the parameters.</p>
<p><span class="math display">\[
\ell(\boldsymbol{\theta} \mid \mathbf{y}) = \log \mathcal{L}(\boldsymbol{\theta} \mid \mathbf{y}) = \sum_{i=1}^n \log f(y_i \mid \boldsymbol{\theta})
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb130"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>) <span class="co"># data from normal distribution</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="co"># data</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1]  1.22864696  0.31256683  1.66088715  0.74832530 -1.26336813  0.03182055</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7]  0.06549473  0.92536938  0.25166170 -0.28649269</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="co"># the model is a normal distribution with mu = 0 and sd = 1</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] 0.1875471 0.3799227 0.1004383 0.3015155 0.1796063 0.3987404 0.3980876</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8] 0.2599950 0.3865070 0.3829015</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="co"># log likelihood</span></span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">dnorm</span>(x, <span class="dv">0</span>, <span class="dv">1</span>)))</span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -12.95385</span></span></code></pre></div>
</div>
</section>
<section id="likelihood-1" class="slide level2">
<h2>Likelihood</h2>
<p>By summing the logarithm all the red segments we obtain the log likelihood of the model given the observed data.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-86-1.svg" class="quarto-figure quarto-figure-center" width="960" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="likelihood-2" class="slide level2">
<h2>Likelihood</h2>
<p>In the previous slide we tried only 3 values for the mean. Let’s image to calculate the log likelihood for several different means. The parameter with that is associated with highest likelihood is called the maximum likelihood estimator. In fact, the <span class="math inline">\(\mu = 0\)</span> is associated with the highest likelihood.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-87-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="deviance" class="slide level2">
<h2>Deviance</h2>
<p>The (residual) deviance in the context of GLM can be considered as the distance between the current model and a perfect model (often called <em>saturated model</em>).</p>
<p><span class="math display">\[
D_{res} = -2[\log(\mathcal{L}_{current}) - (\log\mathcal{L}_{sat})]
\]</span></p>
<p>Where <span class="math inline">\(\mathcal{L}\)</span> is the likelihood of the considered model (see the previous slides). Clearly, the lower the deviance, the closer the current model to the perfect model suggesting a good fit.</p>
</section>
<section id="deviance---saturated-model" class="slide level2">
<h2>Deviance - Saturated model</h2>
<p>The saturated model is a model where each observation <span class="math inline">\(x_i\)</span> has a parameter.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-89-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="deviance---null-model" class="slide level2">
<h2>Deviance - Null model</h2>
<p>Another important quantity is the <em>null deviance</em> that is expressed as the distance between the <em>null model</em> and the <em>saturated model</em>.</p>
<p><span class="math display">\[
D_{null} = -2[\log(\mathcal{L}_{null}) - (\log\mathcal{L}_{sat})]
\]</span></p>
<p>The <em>null deviance</em> can be interpreted as the maximal deviance because is estimated using a model without predictors. A good model will have a residual deviance lower than the null model.</p>
</section>
<section id="deviance---null-model-1" class="slide level2">
<h2>Deviance - Null model</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-90-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="deviance---likelihood-ratio-test" class="slide level2">
<h2>Deviance - Likelihood Ratio Test</h2>
<p>When we perform a likelihood ratio test (see previous slides) we are essentially comparing the residual deviance (or the likelihood) of two models.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb131"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>fit_null <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>fit_current <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span></code></pre></div>
</div>
</section>
<section id="deviance---likelihood-ratio-test-1" class="slide level2">
<h2>Deviance - Likelihood Ratio Test</h2>
<p>With the null model clearly the residual deviance is the same as the null deviance because we are not using predictors to reduce the deviance.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb132"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_null)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; glm(formula = y ~ 1, family = binomial(link = &quot;logit&quot;), data = dat)
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error z value Pr(&gt;|z|)
#&gt; (Intercept)  -0.3228     0.2865  -1.126     0.26
#&gt; 
#&gt; (Dispersion parameter for binomial family taken to be 1)
#&gt; 
#&gt;     Null deviance: 68.029  on 49  degrees of freedom
#&gt; Residual deviance: 68.029  on 49  degrees of freedom
#&gt; AIC: 70.029
#&gt; 
#&gt; Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
</section>
<section id="deviance---likelihood-ratio-test-2" class="slide level2">
<h2>Deviance - Likelihood Ratio Test</h2>
<p>If the predictor <code>x</code> is useful in explaining <code>y</code> the residual deviance will be reduced compared to the null (overall deviance).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb134"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_current)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Call:
#&gt; glm(formula = y ~ x, family = binomial(link = &quot;logit&quot;), data = dat)
#&gt; 
#&gt; Coefficients:
#&gt;             Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; (Intercept)   -5.045      1.470  -3.432 0.000599 ***
#&gt; x              9.535      2.659   3.586 0.000336 ***
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
#&gt; 
#&gt; (Dispersion parameter for binomial family taken to be 1)
#&gt; 
#&gt;     Null deviance: 68.029  on 49  degrees of freedom
#&gt; Residual deviance: 36.745  on 48  degrees of freedom
#&gt; AIC: 40.745
#&gt; 
#&gt; Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
</section>
<section id="deviance---likelihood-ratio-test-3" class="slide level2">
<h2>Deviance - Likelihood Ratio Test</h2>
<p>Comparing the two models we can understand if the deviance reduction can be considered statistically significant.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb136"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_null, fit_current, <span class="at">test =</span> <span class="st">&quot;LRT&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 5
#&gt;   `Resid. Df` `Resid. Dev`    Df Deviance    `Pr(&gt;Chi)`
#&gt;         &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;         &lt;dbl&gt;
#&gt; 1          49         68.0    NA     NA   NA           
#&gt; 2          48         36.7     1     31.3  0.0000000223</code></pre>
</div>
</div>
<p>Notice that the difference between the two residual deviances is the test statistics that is distributed as a <span class="math inline">\(\chi^2\)</span> with <span class="math inline">\(df = 1\)</span>.</p>
</section>
<section id="deviance---likelihood-ratio-test-4" class="slide level2">
<h2>Deviance - Likelihood Ratio Test</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/lrt.svg" class="quarto-figure quarto-figure-center" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="deviance-1" class="slide level2">
<h2>Deviance<a href="#/fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-97-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="deviance---example" class="slide level2">
<h2>Deviance - Example</h2>
<p>Let’s fit the three models:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb138"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># null</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">glm</span>(exam <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="co"># current</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(exam <span class="sc">~</span> tv_shows, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="co"># saturated</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>fits <span class="ot">&lt;-</span> <span class="fu">glm</span>(exam <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> id, <span class="at">data =</span> dat, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span></code></pre></div>
</div>
</section>
<section id="deviance---example-1" class="slide level2">
<h2>Deviance - Example</h2>
<p>We can calculate the residual deviance:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb139"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">logLik</span>(fit) <span class="sc">-</span> <span class="fu">logLik</span>(fits))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; &#39;log Lik.&#39; 126.3001 (df=2)</code></pre>
</div>
<div class="sourceCode" id="cb141"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 126.3001</code></pre>
</div>
</div>
<p>We can calculate the null deviance:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb143"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">logLik</span>(fit0) <span class="sc">-</span> <span class="fu">logLik</span>(fits))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; &#39;log Lik.&#39; 130.6836 (df=1)</code></pre>
</div>
<div class="sourceCode" id="cb145"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">deviance</span>(fit0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 130.6836</code></pre>
</div>
</div>
</section>
<section id="r2" class="slide level2">
<h2><span class="math inline">\(R^2\)</span></h2>
<p>Compared to the standard linear regression, there are multiple ways to calculate an <span class="math inline">\(R^2\)</span> like measure for GLMs and there is no consensus about the most appropriate method. There are some useful resources:</p>
<ul>
<li class="fragment">https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-what-are-pseudo-r-squareds/</li>
</ul>
<div class="fragment">
<p>To note, some measures are specific for the binomial GLM while other measures can be applied also to other GLMs (e.g., the poisson)</p>
</div>
</section>
<section id="r2-1" class="slide level2">
<h2><span class="math inline">\(R^2\)</span></h2>
<p>We will se:</p>
<ul>
<li class="fragment">McFadden’s pseudo-<span class="math inline">\(R^2\)</span> (for GLMs in general)</li>
<li class="fragment">Tjur’s <span class="math inline">\(R^2\)</span> (only for binomial/binary models)</li>
</ul>
</section>
<section id="mcfaddens-pseudo-r2" class="slide level2">
<h2>McFadden’s pseudo-<span class="math inline">\(R^2\)</span></h2>
<p>The McFadden’s pseudo-<span class="math inline">\(R^2\)</span> compute the ratio between the log-likelihood of the intercept-only (i.e., null) model and the current model<span class="citation" data-cites="McFadden1987-qq">(<a href="#/ref-McFadden1987-qq" role="doc-biblioref">McFadden, 1987</a>)</span>:</p>
<p><span class="math display">\[
R^2 = 1 - \frac{\log(\mathcal{L_{current}})}{\log(\mathcal{L_{null}})}
\]</span></p>
<p>There is also the adjusted version that take into account the number of parameters of the model. In R can be computed manually or using the <code>performance::r2_mcfadden()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb147"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2_mcfadden</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # R2 for Generalized Linear Regression
#&gt;        R2: 0.034
#&gt;   adj. R2: 0.018</code></pre>
</div>
</div>
</section>
<section id="tjurs-r2" class="slide level2">
<h2>Tjur’s <span class="math inline">\(R^2\)</span></h2>
<p>This measure is the easiest to interpret and calculate but can only be applied for binomial binary models <span class="citation" data-cites="Tjur2009-ml">(<a href="#/ref-Tjur2009-ml" role="doc-biblioref">Tjur, 2009</a>)</span>. Is the absolute value of the difference between the proportions of correctly classifying <span class="math inline">\(y = 1\)</span> and <span class="math inline">\(y = 0\)</span> from the model:</p>
<p><span class="math display">\[\begin{align*}
\pi_0 = \frac{1}{n_0} \sum_{i = 1}^{n_0} \hat p_i \\
\pi_1 = \frac{1}{n_1} \sum_{i = 1}^{n_1} \hat p_i
R^2 = \abs{\pi_1 - \pi_0}
\end{align*}\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb149"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">r2_tjur</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  Tjur&#39;s R2 
#&gt; 0.04340278</code></pre>
</div>
</div>
</section>
<section id="tjurs-r2-1" class="slide level2">
<h2>Tjur’s <span class="math inline">\(R^2\)</span></h2>
<p>We can do the same manually to check the result:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb151"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># predict the probability of each observation</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted probabilities of y = 0</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>p0 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pp[fit<span class="sc">$</span>y <span class="sc">==</span> <span class="dv">0</span>])</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="co"># predicted probabilities of y = 1</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(pp[fit<span class="sc">$</span>y <span class="sc">==</span> <span class="dv">1</span>])</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a><span class="co"># R2</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(p1 <span class="sc">-</span> p0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.04340278</code></pre>
</div>
</div>
</section>
<section id="residuals" class="slide level2">
<h2>Residuals</h2>
<p>The main problem of GLM is that the mean and the variance are linked. For example, the mean of a binomial distribution is <span class="math inline">\(np\)</span> and the variance is <span class="math inline">\(np(1-p)\)</span>. In the standard linear model we have two parameters, <span class="math inline">\(\mu\)</span> and the residual <span class="math inline">\(\sigma\)</span> that are independent.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb153"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="sc">+</span> <span class="fl">0.6</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>ri_lm <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit) <span class="sc">/</span> <span class="fu">sigma</span>(fit)</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(fit), ri_lm, </span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Fitted Values&quot;</span>,</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Standardized Residuals&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-105-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residuals-1" class="slide level2">
<h2>Residuals</h2>
<p>When using a linear model (thus assuming a constant <span class="math inline">\(\sigma\)</span> and independence between mean and variance) the residuals pattern is very different:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb154"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1000</span>, <span class="fu">exp</span>(<span class="fu">log</span>(<span class="dv">10</span>) <span class="sc">+</span> <span class="fu">log</span>(<span class="fl">1.5</span>) <span class="sc">*</span> x))</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>fit_poi <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(fit_poi), <span class="fu">rstandard</span>(fit_poi),</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Standardized Residuals&quot;</span>,</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Fitted Values&quot;</span>)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-106-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="residuals-2" class="slide level2">
<h2>Residuals</h2>
<p>As for standard linear models there are different types of residuals:</p>
<ul>
<li class="fragment">raw (response) residuals</li>
<li class="fragment">pearson residuals</li>
<li class="fragment">deviance residuals</li>
<li class="fragment">standardized residuals</li>
</ul>
</section>
<section id="raw-residuals" class="slide level2">
<h2>Raw Residuals</h2>
<p>Raw residuals, also called response residuals are the simplest type of residuals. They are calculated as in standard regression as:</p>
<p><span class="math display">\[\begin{align*}
r_i = y_i - \hat y_i
\end{align*}\]</span></p>
<p>Where <span class="math inline">\(\hat y_i\)</span> are the fitted values where the inverse of the link function has been applied.</p>
<p>In R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb155"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># equivalent to residuals(fit, type = &quot;response&quot;) </span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>ri <span class="ot">&lt;-</span> fit<span class="sc">$</span>y <span class="sc">-</span> <span class="fu">fitted</span>(fit)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>ri[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          1          2          3          4          5 
#&gt; 0.56826521 0.18039223 0.07097155 0.56848124 0.04399144</code></pre>
</div>
</div>
<p>The problem is that in GLMs the mean and the variance of the distribution are not independent, creating problems in residual analysis.</p>
</section>
<section id="raw-residuals-1" class="slide level2">
<h2>Raw Residuals</h2>
<p>We can use the function <code>car::residualPlot()</code> to plot different type of residuals against fitted values:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb157"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">residualPlot</span>(fit, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-109-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="why-raw-residuals-are-problematic" class="slide level2">
<h2>Why raw residuals are problematic?</h2>
<p>This plot<a href="#/fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> shows an example with the same residual for two different <span class="math inline">\(x\)</span> values on a Poisson GLM. Beyond the model itself, the same residual can be considered as extreme for low <span class="math inline">\(x\)</span> values and plausible for high <span class="math inline">\(x\)</span> values:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-110-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="binned-raw-residuals" class="slide level2">
<h2>Binned (raw) Residuals</h2>
<p>Gelman and colleagues <span class="citation" data-cites="Gelman2020-tg">Gelman &amp; Hill (<a href="#/ref-Gelman2006-pc" role="doc-biblioref">2006</a>)</span> proposed a type of residuals called <strong>binned residuals</strong> to solve the problem of the previous plot for Binomial GLMs:</p>
<ul>
<li class="fragment">divide the fitted values into <span class="math inline">\(n\)</span> bins. The number is arbitrary but we need each bin to have enough observation to compute a reliable average</li>
<li class="fragment">calculate the average fitted value and residual for each bin</li>
<li class="fragment">for each bin we can compute the standard error as <span class="math inline">\(SE = \frac{\hat p_j (1 - p_j)}{n_j}\)</span> where <span class="math inline">\(p_j\)</span> is the average fitted probability and <span class="math inline">\(n_j\)</span> is the number of observation in the bin <span class="math inline">\(j\)</span></li>
<li class="fragment">Then we can plot each bin and the confidence intervals (e.g., as <span class="math inline">\(\pm 2*SE\)</span>) where ~95% of binned residuals should be within the CI if the model is true</li>
</ul>
</section>
<section id="binned-raw-residuals-1" class="slide level2">
<h2>Binned (raw) Residuals</h2>
<p>We can use the <code>arm::binnedplot()</code> function to automatically create and plot the binned residuals:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb158"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">xlab =</span> <span class="st">&quot;Expected Values&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Raw Residual&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Raw Residual Plot&quot;</span>)</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">binnedplot</span>(x,y)</span></code></pre></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-112-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pearson-residuals" class="slide level2">
<h2>Pearson residuals</h2>
<p>Pearson residuals are raw residuals divided by the standard deviation of each residual. Given that the mean-variance relationship of GLMs, dividing by the standard deviation partially solve the mean-variance relationship. The denominator can be calculated just using the appropriate variance formula for that specific GLM.</p>
<p><span class="math display">\[
r_i = \frac{y_i - \hat y_i}{\sqrt{V(\hat y_i)}}
\]</span></p>
</section>
<section id="pearson-vs-raw-residuals" class="slide level2">
<h2>Pearson vs Raw residuals</h2>
<p>We can see the difference for a Poisson model<a href="#/fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a> when using raw vs pearson residuals. The non-constant variance is controlled on the right.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-113-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pearson-residuals-1" class="slide level2">
<h2>Pearson residuals</h2>
<p>For the Binomial (Bernoulli) GLM, the variance is calculated as <span class="math inline">\(\hat p(1 - \hat p)\)</span> where <span class="math inline">\(\hat p\)</span> is the residual value.</p>
<p><span class="math display">\[
r_i = \frac{y_i - \hat y_i}{\sqrt{\hat y_i(1 - \hat y_i)}}
\]</span></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb159"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co"># equivalent to residuals(fit, type = &quot;pearson&quot;)</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>yi <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit)</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>ri_pearson <span class="ot">&lt;-</span> ri <span class="sc">/</span> <span class="fu">sqrt</span>(yi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> yi))</span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>ri_pearson[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          1          2          3          4          5 
#&gt; 1.17341398 0.42948479 0.14213499 1.21450070 0.09047435</code></pre>
</div>
</div>
</section>
<section id="deviance-residuals" class="slide level2">
<h2>Deviance residuals</h2>
<p>Deviance residuals are based on the residual deviance that we defined before. In fact, the residual deviance was just the sum of squared deviance residuals.</p>
<p><span class="math display">\[
r_i = sign(y_i - \hat y_i) \sqrt{-2[\log \mathcal{L}y_{i_{current}} - \log \mathcal{L}y_{i_{saturated}}]}
\]</span> Where <span class="math inline">\(sign\)</span> is the sign of the raw residual <span class="math inline">\(i\)</span>. For the Bernoulli model the <span class="math inline">\(\log \mathcal{L}y_{i_{saturated}}\)</span> is always 0.</p>
</section>
<section id="deviance-residuals-1" class="slide level2">
<h2>Deviance Residuals</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-115-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="deviance-residuals-2" class="slide level2">
<h2>Deviance Residuals</h2>
<p>To calculate and demonstrate manually the deviance residuals we can compute them manually in R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb161"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># residual(fit, type = &quot;deviance&quot;)</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit) <span class="co"># fitted</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> fit<span class="sc">$</span>y <span class="co"># actual values</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="co"># the likelihood is dbinom</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>ri_dev <span class="ot">&lt;-</span> <span class="fu">sign</span>(y <span class="sc">-</span> yhat) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>(<span class="fu">log</span>(<span class="fu">dbinom</span>(y, <span class="dv">1</span>, yhat)) <span class="sc">-</span> <span class="fu">log</span>(<span class="fu">dbinom</span>(y, <span class="dv">1</span>, y))))</span></code></pre></div>
</div>
</section>
<section id="deviance-residuals-3" class="slide level2">
<h2>Deviance Residuals</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb162"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="co"># notice that the log lik of the saturated model log(dbinom(y, 1, y)) is 0</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">dbinom</span>(y, <span class="dv">1</span>, y))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 
#&gt;  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 
#&gt; 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 
#&gt;  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</code></pre>
</div>
<div class="sourceCode" id="cb164"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>ri_dev[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          1          2          3          4          5 
#&gt; -0.2370588  0.3033530 -1.0310244  0.2331303 -0.8429485</code></pre>
</div>
<div class="sourceCode" id="cb166"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(fit, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          1          2          3          4          5 
#&gt; -0.2370588  0.3033530 -1.0310244  0.2331303 -0.8429485</code></pre>
</div>
</div>
</section>
<section id="quick-recap-about-hat-values-in-linear-regression" class="slide level2">
<h2>Quick recap about hat values in linear regression</h2>
<p></p>
<p>The <strong>hat matrix</strong> <span class="math inline">\(H\)</span> is calculated as <span class="math inline">\(H = X \left(X^{\top} X \right)^{-1} X^{\top}\)</span> is a <span class="math inline">\(n \times n\)</span> matrix where <span class="math inline">\(n\)</span> is the number of observations. The diagonal of the <span class="math inline">\(H\)</span> matrix contained the hat values or leverages.</p>
<p>The <span class="math inline">\(i^{th}\)</span> leverage score (<span class="math inline">\(h_{ii}\)</span>) is interpreted as the weighted distance between <span class="math inline">\(x_i\)</span> and the mean of <span class="math inline">\(x_i\)</span>’s. In practical terms is the <span class="math inline">\(i^{th}\)</span> observed value influence the <span class="math inline">\(i^{th}\)</span> fitted value. An high leverage suggest that the observation is far from the mean of predictors and have an high influence on the fitted values.</p>
<ul>
<li class="fragment"><span class="math inline">\(h_{ii}\)</span> ranges between 0 and 1</li>
<li class="fragment">The sum of all <span class="math inline">\(h_{ii}\)</span> values is the number of parameters <span class="math inline">\(p\)</span></li>
<li class="fragment">As a rule of thumb, an observation have an high leverage if <span class="math inline">\(h_{ii} &gt; 2 \bar h\)</span> where <span class="math inline">\(\bar h\)</span> is the average hat value</li>
</ul>
</section>
<section id="quick-recap-about-hatvalues-in-linear-regression" class="slide level2">
<h2>Quick recap about hatvalues in linear regression</h2>
<!-- TODO add fox 11.2 reference -->
<p>For a simple linear regression (<span class="math inline">\(y \sim x\)</span>) the hat values are calculated as:</p>
<p><span class="math display">\[
h_i = \frac{1}{n} + \frac{(X_i - \bar X)^2}{\sum^n_{j = 1}(X_i - \bar X)^2}
\]</span></p>
<p>In R the function <code>hatvalues()</code> return the diagonal of the <span class="math inline">\(H\)</span> matrix for <code>glm</code> and <code>lm</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb168"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hatvalues</span>(fit)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          1          2          3          4          5          6          7 
#&gt; 0.02874015 0.03492581 0.03968557 0.02782301 0.04357230 0.04652508 0.04435804 
#&gt;          8          9         10 
#&gt; 0.04012613 0.03948651 0.04743780</code></pre>
</div>
</div>
<p>To note, for GLM and multiple regression in general, the equation is different and more complicated but the intepretation and the R implementation is the same.</p>
</section>
<section id="standardized-residuals" class="slide level2">
<h2>Standardized Residuals</h2>
<p>Both the response, pearson and deviance residuals can be considered as raw residuals. We can standardize residuals by dividing for the standard error computed with the hat values. In this way, the distribution will be approximately normal with <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma = 1\)</span>.</p>
<p><span class="math display">\[
r_{s_i} = \frac{r_i}{\sqrt{(1 - \hat h_{ii})}}
\]</span></p>
<p>Where <span class="math inline">\(r_i\)</span> can be raw, pearson or deviance residuals.</p>
</section>
<section id="standardized-residuals-1" class="slide level2">
<h2>Standardized Residuals</h2>
<p>In R they can be extracted using <code>rstandard()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb170"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rstandard</span>(fit, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          1          2          3          4          5 
#&gt; -0.1712897  0.2208858 -0.8546823  0.1683326 -0.6678440</code></pre>
</div>
<div class="sourceCode" id="cb172"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rstandard</span>(fit, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          1          2          3          4          5 
#&gt; -0.2405406  0.3087934 -1.0521126  0.2364427 -0.8619359</code></pre>
</div>
</div>
</section>
<section id="standardized-residuals-2" class="slide level2 allowframebreaks">
<h2 class="allowframebreaks">Standardized Residuals</h2>
<p>We can try to manually calculate the residuals to better understand.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb174"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> <span class="fu">fitted</span>(fit) <span class="co"># fitted</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>yi <span class="ot">&lt;-</span> fit<span class="sc">$</span>y <span class="co"># observed</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>hi <span class="ot">&lt;-</span> <span class="fu">hatvalues</span>(fit) <span class="co"># diagonal of the hat matrix</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pearson residuals</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> (yi <span class="sc">-</span> yhat) <span class="sc">/</span> <span class="fu">sqrt</span>(yhat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> yhat))</span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a><span class="co"># standardized</span></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>pis <span class="ot">&lt;-</span> pi <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> hi)</span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>pis[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          1          2          3          4          5 
#&gt; -0.1712897  0.2208858 -0.8546823  0.1683326 -0.6678440</code></pre>
</div>
<div class="sourceCode" id="cb176"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rstandard</span>(fit, <span class="at">type =</span> <span class="st">&quot;pearson&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          1          2          3          4          5 
#&gt; -0.1712897  0.2208858 -0.8546823  0.1683326 -0.6678440</code></pre>
</div>
</div>
</section>
<section id="standardized-residuals-3" class="slide level2 allowframebreaks">
<h2 class="allowframebreaks">Standardized Residuals</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb178"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># deviance (for binomial GLM the loglik of the saturated model is 0)</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>di <span class="ot">&lt;-</span> <span class="fu">sign</span>(yi <span class="sc">-</span> yhat) <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="fu">dbinom</span>(y, <span class="dv">1</span>, yhat)))</span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="co"># standardized</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a>dis <span class="ot">&lt;-</span> di <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> hi)</span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a>dis[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          1          2          3          4          5 
#&gt; -0.2405406  0.3087934 -1.0521126  0.2364427 -0.8619359</code></pre>
</div>
<div class="sourceCode" id="cb180"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rstandard</span>(fit, <span class="at">type =</span> <span class="st">&quot;deviance&quot;</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;          1          2          3          4          5 
#&gt; -0.2405406  0.3087934 -1.0521126  0.2364427 -0.8619359</code></pre>
</div>
</div>
</section>
<section id="quantile-residuals" class="slide level2">
<h2>Quantile residuals</h2>
<p>The <strong>quantile residuals</strong> is another proposal for residual analysis. The idea is to map the quantile of the cumulative density function (CDF) of the random component into the CDF of the normal distribution.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-123-1.svg" class="quarto-figure quarto-figure-center" width="960" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="quantile-residuals-1" class="slide level2">
<h2>Quantile residuals</h2>
<p><strong>Quantile residuals</strong> are very useful especially for Discrete GLMs (binomial and poisson) and are exactly normally distributed (under respected model assumptions) compared to <strong>deviance</strong> and <strong>pearson</strong> residuals <span class="citation" data-cites="Dunn1996-yd">(<a href="#/ref-Dunn1996-yd" role="doc-biblioref">Dunn &amp; Smyth, 1996</a>)</span>. They can be calculated using the <code>statmod::qresid(fit)</code> function. Authors suggest to run the function 4 times to disentagle between the randomization and the systematic component.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb182"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>statmod<span class="sc">::</span><span class="fu">qresid</span>(fit)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] -0.33677932  1.04616589 -0.43878900  0.01511622 -1.07265867</code></pre>
</div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>statmod<span class="sc">::</span><span class="fu">qresid</span>(fit)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>] <span class="co"># different every time</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1]  1.2349067 -0.6689038  0.2171433 -0.9988869 -0.4189008</code></pre>
</div>
</div>
</section>
<section id="quantile-residuals-2" class="slide level2">
<h2>Quantile residuals</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-125-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="more-on-residuals" class="slide level2">
<h2>More on residuals</h2>
<p>Residuals for GLMs are complicated. To have a more detailed and clear overview see:</p>
<ul>
<li class="fragment"><span class="citation" data-cites="Agresti2015-cz">Agresti (<a href="#/ref-Agresti2015-cz" role="doc-biblioref">2015</a>)</span>, Sections 4.4.5, 4.4.6</li>
<li class="fragment"><span class="citation" data-cites="Dunn2018-ww">Dunn &amp; Smyth (<a href="#/ref-Dunn2018-ww" role="doc-biblioref">2018</a>)</span>, Chapter 8</li>
</ul>
</section>
<section id="classification-accuracyerror-rate" class="slide level2">
<h2>Classification accuracy/Error rate</h2>
<p>The <strong>error rate</strong> (ER) is defined as the proportion of cases for which the deterministic prediction i.e. guessing <span class="math inline">\(y_i = 1\)</span> if <span class="math inline">\(logit^{-1}(\hat y_i) &gt; 0.5\)</span> and guessing <span class="math inline">\(y_i = 0\)</span> if <span class="math inline">\(logit^{-1}(\hat y_i) &gt; 0.5\)</span> is wrong. Clearly, <span class="math inline">\(1 - ER\)</span> is the <strong>classification accuracy</strong>.</p>
<p>I wrote the <code>error_rate</code> function that simply compute the error rate of a given model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>error_rate <span class="ot">&lt;-</span> <span class="cf">function</span>(fit) {</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  pi <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  yi <span class="ot">&lt;-</span> fit<span class="sc">$</span>y</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>  cr <span class="ot">&lt;-</span> <span class="fu">mean</span>((pi <span class="sc">&gt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> yi <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">|</span> (pi <span class="sc">&lt;</span> <span class="fl">0.5</span> <span class="sc">&amp;</span> yi <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> cr <span class="co"># error rate</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
</section>
<section id="classification-accuracyerror-rate-1" class="slide level2">
<h2>Classification accuracy/Error rate</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb187"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">error_rate</span>(fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.14</code></pre>
</div>
</div>
<p>We could compare the error rate of a given model with the error rate of the null model or another similar model (with a model comparison approach):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb189"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>fit0 <span class="ot">&lt;-</span> <span class="fu">update</span>(fit, . <span class="sc">~</span> <span class="sc">-</span>x) <span class="co"># removing the x predictor, now intercept only model</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">error_rate</span>(fit0)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.48</code></pre>
</div>
<div class="sourceCode" id="cb191"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the error rate of the null model is ... greater/less than the actual model</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>er_ratio <span class="ot">=</span> <span class="fu">error_rate</span>(fit0)<span class="sc">/</span><span class="fu">error_rate</span>(fit)</span></code></pre></div>
</div>
<p>The <strong>error rate</strong> of the null model is 3.429 times greater than the actual model.</p>
</section>
<section id="classification-accuracyerror-rate-2" class="slide level2">
<h2>Classification accuracy/Error rate</h2>
<ul>
<li class="fragment">For a given model, the error rate should be less than <span class="math inline">\(0.5\)</span>, otherwise setting all <span class="math inline">\(\beta\)</span>’s to 0 (i.e., null model) would be considered a better model <span class="citation" data-cites="Gelman2020-tg">(<a href="#/ref-Gelman2020-tg" role="doc-biblioref">Gelman et al., 2020</a>)</span>.</li>
<li class="fragment">For example if the average <span class="math inline">\(p\)</span> in a dataset is <span class="math inline">\(\overline p = 0.3\)</span> means that a null model would have an error rate of <span class="math inline">\(0.3\)</span> and a classification accuracy of <span class="math inline">\(1 - \overline p = 0.7\)</span>.</li>
<li class="fragment">When the proportion of 1s and 0s is the same, the error rate of the null model is 0.5, otherwise is the proportion of 1s</li>
<li class="fragment">Including predictors we aim to reduce the error rate (compared to the null model) because the ability to correctly classify an observation increase.</li>
<li class="fragment">The error rate can be misleading, see <span class="citation" data-cites="Gelman2020-tg">Gelman et al. (<a href="#/ref-Gelman2020-tg" role="doc-biblioref">2020</a>)</span> (pp. 255-256)</li>
</ul>
</section>
<section id="outliers-and-influential-observations" class="slide level2">
<h2>Outliers and influential observations</h2>
<p>Identification of influential observation and outliers of GLMs is very similar to standard regression models. We will briefly see:</p>
<ul>
<li class="fragment">Cook Distances</li>
<li class="fragment">DFBETAs</li>
</ul>
</section>
<section id="cook-distances" class="slide level2">
<h2>Cook Distances</h2>
<p>The Cook Distance of an observation <span class="math inline">\(i\)</span> measured the impact of that observation on the overall model fit. If removing the observation <span class="math inline">\(i\)</span> has an high impact, the observation <span class="math inline">\(i\)</span> is likely an influential observation. For GLMs they are defined as:</p>
<p><span class="math display">\[\begin{align*}
D_i = \frac{r_i^2}{\phi p} \frac{h_{ii}}{1 - h_{ii}}
\end{align*}\]</span></p>
<p>Where <span class="math inline">\(p\)</span> is the number of model parameters, <span class="math inline">\(r_i\)</span> are the standardized pearson residuals (<code>rstandard(fit, type = "pearson")</code>) and <span class="math inline">\(h_{ii}\)</span> are the hatvalues (leverages). <span class="math inline">\(\phi\)</span> is the dispersion parameter of the GLM that for binomial and poisson models is fixed to 1 (see Dunn (2018, Table 5.1)) Usually an observation is considered influential if <span class="math inline">\(D_i &gt; \frac{4}{n}\)</span> where <span class="math inline">\(n\)</span> is the sample size.</p>
</section>
<section id="dfbetas" class="slide level2">
<h2>DFBETAs</h2>
<p>DFBETAs measure the impact of the observation <span class="math inline">\(i\)</span> on the estimated parameter <span class="math inline">\(\beta_j\)</span>:</p>
<p><span class="math display">\[\begin{align*}
DFBETAS_i = \frac{\beta_j - \beta_{j(i))}}{\sigma_{\beta_{j(i)}}}
\end{align*}\]</span></p>
<p>Where <span class="math inline">\(i\)</span> denote the parameters and standard error on a model fitted without the <span class="math inline">\(i\)</span> observation<a href="#/fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a>. Usually an observation is considered influential if <span class="math inline">\(|DFBETAs_{i}| &gt; \frac{2}{\sqrt{n}}\)</span> where <span class="math inline">\(n\)</span> is the sample size.</p>
</section>
<section id="extracting-influence-measures" class="slide level2">
<h2>Extracting influence measures</h2>
<p>In R we can use the <code>influence.measures()</code> function to calculate each influence measure explained before<a href="#/fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb192"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">update</span>(fit, <span class="at">data =</span> fit<span class="sc">$</span>model[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, ])</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb193"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>infl <span class="ot">&lt;-</span> <span class="fu">influence.measures</span>(fit)<span class="sc">$</span>infmat</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(infl)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;        dfb.1_      dfb.x       dffit    cov.r       cook.d        hat
#&gt; 1 -0.04419414 0.04109800 -0.04442749 1.070827 0.0004340963 0.02874015
#&gt; 2 -0.04672053 0.05681844  0.06310261 1.075710 0.0008828590 0.03492581
#&gt; 3 -0.11865551 0.05713533 -0.23265873 1.028011 0.0150937972 0.03968557
#&gt; 4 -0.03348170 0.03972704  0.04294688 1.069920 0.0004054759 0.02782301
#&gt; 5 -0.14588644 0.10150547 -0.19921442 1.051194 0.0101596403 0.04357230
#&gt; 6 -0.07575414 0.10700698  0.14303484 1.074641 0.0048052405 0.04652508</code></pre>
</div>
</div>
<p>The first two columns are the DFBETAs for each parameter, the <code>cook.d</code> columns contains the Cook Distances and <code>hat</code> is the diagonal of the <span class="math inline">\(H\)</span> matrix.</p>
</section>
<section id="plotting-influence-measures" class="slide level2">
<h2>Plotting influence measures</h2>
<p>I wrote the <code>cook_plot()</code> function to easily plot the cook distances along with the identification of influential observations:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb195"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cook_plot</span>(fit)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-132-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plotting-influence-measures-1" class="slide level2">
<h2>Plotting influence measures</h2>
<p>I wrote the <code>dfbeta_plot()</code> function to easily plot the cook distances along with the identification of influential observations:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb196"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dfbeta_plot</span>(fit)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-134-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="binomial-vs-binary" class="slide level2">
<h2>Binomial vs Binary</h2>
<p>There are several practical differences between binomial and binary models:</p>
<ul>
<li class="fragment">data structure</li>
<li class="fragment">fitting function in R</li>
<li class="fragment">residuals and residual deviance</li>
<li class="fragment">type of predictors</li>
</ul>
</section>
<section id="binomial-vs-binary-data-structure" class="slide level2">
<h2>Binomial vs Binary data structure</h2>
<p>The most basic Binomial regression is a vector of binary <span class="math inline">\(y\)</span> values and a continuous or categorical predictor. Let’s see a common data structure in this case:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb197"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_design</span>(<span class="at">ns =</span> n, <span class="at">nx =</span> <span class="fu">list</span>(<span class="at">x =</span> x))</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(<span class="fl">0.01</span>)</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sim_data</span>(<span class="fu">plogis</span>(b0 <span class="sc">+</span> b1<span class="sc">*</span>x), <span class="st">&quot;binomial&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>lp) <span class="sc">|&gt;</span> </span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">|&gt;</span> </span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>    filor<span class="sc">::</span><span class="fu">trim_df</span>(<span class="dv">4</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 9 × 3
#&gt;   id    x     y    
#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1 1     0.85  1    
#&gt; 2 2     0.16  0    
#&gt; 3 3     0.08  0    
#&gt; 4 4     0.17  0    
#&gt; 5 ...   ...   ...  
#&gt; 6 27    0.52  1    
#&gt; 7 28    0.64  1    
#&gt; 8 29    0.11  0    
#&gt; 9 30    0.54  1</code></pre>
</div>
</div>
</section>
<section id="binomial-vs-binary-data-structure-1" class="slide level2">
<h2>Binomial vs Binary data structure</h2>
<p>Or equivalently with a categorical variable:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb199"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">sim_design</span>(n, <span class="at">cx =</span> <span class="fu">list</span>(<span class="at">x =</span> x))</span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">qlogis</span>(<span class="fl">0.4</span>)</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="fu">odds_ratio</span>(<span class="fl">0.7</span>, <span class="fl">0.4</span>))</span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sim_data</span>(<span class="fu">plogis</span>(b0 <span class="sc">+</span> b1<span class="sc">*</span>x_c), <span class="st">&quot;binomial&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>x_c, <span class="sc">-</span>lp) <span class="sc">|&gt;</span> </span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a>    filor<span class="sc">::</span><span class="fu">trim_df</span>(<span class="dv">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 9 × 3
#&gt;   id    x     y    
#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1 1     a     1    
#&gt; 2 2     b     0    
#&gt; 3 3     a     0    
#&gt; 4 4     b     0    
#&gt; 5 ...   ...   ...  
#&gt; 6 27    a     0    
#&gt; 7 28    b     1    
#&gt; 8 29    a     0    
#&gt; 9 30    b     0</code></pre>
</div>
</div>
</section>
<section id="binomial-vs-binary-data-structure-2" class="slide level2">
<h2>Binomial vs Binary data structure</h2>
<p>When using a Binomial data structure we count the number of success for each level of <span class="math inline">\(x\)</span>. <code>nc</code> is the number of 1 responses, <code>nf</code> is the number of 0 response out of <code>nt</code> trials:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb201"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.05</span>)</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb201-3"><a href="#cb201-3" aria-hidden="true" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">length</span>(x), nt, <span class="fu">plogis</span>(<span class="fu">qlogis</span>(<span class="fl">0.01</span>) <span class="sc">+</span> <span class="dv">8</span><span class="sc">*</span>x))</span>
<span id="cb201-4"><a href="#cb201-4" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, nc, <span class="at">nf =</span> nt <span class="sc">-</span> nc,  nt)</span>
<span id="cb201-5"><a href="#cb201-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-6"><a href="#cb201-6" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb201-7"><a href="#cb201-7" aria-hidden="true" tabindex="-1"></a>    filor<span class="sc">::</span><span class="fu">trim_df</span>(<span class="dv">4</span>)</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 9 × 4
#&gt;   x     nc    nf    nt   
#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1 0     0     10    10   
#&gt; 2 0.05  0     10    10   
#&gt; 3 0.1   1     9     10   
#&gt; 4 0.15  0     10    10   
#&gt; 5 ...   ...   ...   ...  
#&gt; 6 0.85  9     1     10   
#&gt; 7 0.9   8     2     10   
#&gt; 8 0.95  9     1     10   
#&gt; 9 1     10    0     10</code></pre>
</div>
</div>
</section>
<section id="binomial-vs-binary-data-structure-3" class="slide level2">
<h2>Binomial vs Binary data structure</h2>
<p>With a categorical variable we have essentially a contingency table:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb203"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>nt <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>nc <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">length</span>(x), nt, <span class="fu">plogis</span>(<span class="fu">qlogis</span>(<span class="fl">0.4</span>) <span class="sc">+</span> <span class="fu">log</span>(<span class="fu">odds_ratio</span>(<span class="fl">0.7</span>, <span class="fl">0.4</span>))<span class="sc">*</span><span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="st">&quot;a&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)))</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>datc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, nc, <span class="at">nf =</span> nt <span class="sc">-</span> nc,  nt)</span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>datc</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 4
#&gt;   x        nc    nf    nt
#&gt;   &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
#&gt; 1 a         5     5    10
#&gt; 2 b         4     6    10</code></pre>
</div>
</div>
</section>
<section id="binomial-vs-binary-data-structure-4" class="slide level2">
<h2>Binomial vs Binary: data structure</h2>
<p>Clearly, expanding or aggregating data is the way to convert a binary into a binomial data structure and the opposite:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb205"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from binomial to binary</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bin_to_binary</span>(datc, nc, nt) <span class="sc">|&gt;</span> </span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(y, x) <span class="sc">|&gt;</span> </span>
<span id="cb205-4"><a href="#cb205-4" aria-hidden="true" tabindex="-1"></a>    filor<span class="sc">::</span><span class="fu">trim_df</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 9 × 2
#&gt;   y     x    
#&gt;   &lt;chr&gt; &lt;chr&gt;
#&gt; 1 1     a    
#&gt; 2 1     a    
#&gt; 3 1     a    
#&gt; 4 1     a    
#&gt; 5 ...   ...  
#&gt; 6 0     b    
#&gt; 7 0     b    
#&gt; 8 0     b    
#&gt; 9 0     b</code></pre>
</div>
</div>
</section>
<section id="binomial-vs-binary-data-structure-5" class="slide level2">
<h2>Binomial vs Binary: data structure</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb207"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from binary to binomial</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bin_to_binary</span>(datc, nc, nt)  <span class="sc">|&gt;</span></span>
<span id="cb207-3"><a href="#cb207-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">binary_to_bin</span>(y, x)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 2 × 4
#&gt;   x        nc    nf    nt
#&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
#&gt; 1 a         5     5    10
#&gt; 2 b         4     6    10</code></pre>
</div>
</div>
</section>
<section id="binomial-vs-binary-multilevel-disclaimer" class="slide level2">
<h2>Binomial vs Binary: multilevel disclaimer</h2>
<ul>
<li class="fragment">Clearly, in the previous examples, each row correspond to a single observation (in the binary model) or a condition (in the binomial model). Furthermore each row/observation/participants is assumed to be independent.</li>
<li class="fragment">If participants performed multiple trials for each condition, we can still use a binomial or binary model BUT we need to take into account the multilevel structure.</li>
<li class="fragment">In practice, we need to use a mixed-effects GLM, for example with the <code>lme4::glmer()</code> package specifying the appropriate random structure.</li>
</ul>
</section>
<section id="binomial-vs-binary---fitting-function-in-r" class="slide level2">
<h2>Binomial vs Binary: - fitting function in R</h2>
<p>There is a single way to implement a binary model in R and two ways for the binomial version:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb209"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># binary regression</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="co"># binomial with cbind syntax, nc = number of 1s, nf = number of 0s, nc + nf = nt</span></span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(<span class="fu">cbind</span>(nc, nf) <span class="sc">~</span> x, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a><span class="co"># binomial with proportions and weights, equivalent to the cbind approach, nt is the total trials</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glm</span>(nc<span class="sc">/</span>nt <span class="sc">~</span> x, <span class="at">weights =</span> nt, <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span></code></pre></div>
</div>
</section>
<section id="binomial-vs-binary-residuals-and-residual-deviance" class="slide level2">
<h2>Binomial vs Binary: residuals and residual deviance</h2>
<p>A more relevant difference is about the residual analysis. The binary regression has different residuals compared to the binomial model fitted on the same dataset<a href="#/fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb210"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>fit_binomial <span class="ot">&lt;-</span> <span class="fu">glm</span>(nc<span class="sc">/</span>nt <span class="sc">~</span> x, <span class="at">weights =</span> nt, <span class="at">data =</span> dat_binomial, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>fit_binary <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> dat_binary, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span></code></pre></div>
</div>
</section>
<section id="binomial-vs-binary-residuals-and-residual-deviance-1" class="slide level2">
<h2>Binomial vs Binary: residuals and residual deviance</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-144-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="binomial-vs-binary-residuals-and-residual-deviance-2" class="slide level2">
<h2>Binomial vs Binary: residuals and residual deviance</h2>
<p>The residual deviance is also different. In fact, there is more residual deviance on the binary compared to the binomial model. However, comparing two binary and binomial models actually leads to the same conclusion. In other terms the deviance seems to be on a different scale<a href="#/fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb211"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>fit0_binary <span class="ot">&lt;-</span> <span class="fu">update</span>(fit_binary, . <span class="sc">~</span> <span class="sc">-</span>x) <span class="co"># null binary model</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a>fit0_binomial <span class="ot">&lt;-</span> <span class="fu">update</span>(fit_binomial, . <span class="sc">~</span> <span class="sc">-</span>x) <span class="co"># null binary model</span></span></code></pre></div>
</div>
</section>
<section id="binomial-vs-binary-residuals-and-residual-deviance-3" class="slide level2">
<h2>Binomial vs Binary: residuals and residual deviance</h2>
<p>In fact, if we compare the full model with the null model in both binary and binomial version, the LRT is the same but the deviance is on a different scale. Comparing a binary with a binomial model could be completely misleading.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb212"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_binomial, fit0_binomial, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   `Resid. Df` `Resid. Dev`    Df Deviance `Pr(&gt;Chi)`</span></span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1          19         14.4    NA      NA   NA       </span></span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2          20        148.     -1    -133.   8.27e-31</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_binary, fit0_binary, <span class="at">test =</span> <span class="st">&quot;Chisq&quot;</span>)</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   `Resid. Df` `Resid. Dev`    Df Deviance `Pr(&gt;Chi)`</span></span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1         208         156.    NA      NA   NA       </span></span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2         209         289.    -1    -133.   8.27e-31</span></span></code></pre></div>
</div>
</section>
<section id="binomial-vs-binary-type-of-predictors" class="slide level2">
<h2>Binomial vs Binary: type of predictors</h2>
<p>This point is less relevant in this course but important in general. Usually, <strong>binary regression</strong> is used when the predictor is at the <em>trial level</em> whereas <strong>binomial regression</strong> is used when the predictor is at the <em>participant level</em>. When both levels are of interests one should use a mixed-effects model where both levels can be modeled.</p>
<ul>
<li class="fragment">the probability of correct responses during an exam as a function of the question difficulty (each trial/row could have a different <span class="math inline">\(x\)</span> level)</li>
<li class="fragment">the probability of passing the exam as a function of the high-school background regardless of having multiple trials, each trial/row has the same <span class="math inline">\(x_i\)</span> for the participant <span class="math inline">\(i\)</span></li>
</ul>
</section>
<section id="binomial-vs-binary-type-of-predictors-1" class="slide level2">
<h2>Binomial vs Binary: type of predictors</h2>
<blockquote>
<p>The probability of correct responses during an exam as a function of the question difficulty</p>
</blockquote>
<ul>
<li class="fragment">each question (i.e., <em>trial</em>) has a 0/1 response and a difficulty level</li>
<li class="fragment">we are modelling a single participant, otherwise we need a multilevel (mixed-effects) model</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode" id="cb213"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">id =</span> <span class="dv">1</span>, <span class="at">question =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)</span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="fu">nrow</span>(dat), <span class="dv">1</span>, <span class="fl">0.7</span>)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>difficulty <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">nrow</span>(dat), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>dat <span class="sc">|&gt;</span> </span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(id, question, difficulty, y) <span class="sc">|&gt;</span> </span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a>    filor<span class="sc">::</span><span class="fu">trim_df</span>()</span></code></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 9 × 4
#&gt;   id    question difficulty y    
#&gt;   &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;chr&gt;
#&gt; 1 1     1        1          1    
#&gt; 2 1     2        3          1    
#&gt; 3 1     3        3          1    
#&gt; 4 1     4        1          0    
#&gt; 5 ...   ...      ...        ...  
#&gt; 6 1     27       1          1    
#&gt; 7 1     28       5          1    
#&gt; 8 1     29       1          0    
#&gt; 9 1     30       1          1</code></pre>
</div>
</div>
</section>
<section id="binomial-vs-binary-type-of-predictors-2" class="slide level2">
<h2>Binomial vs Binary: type of predictors</h2>
<blockquote>
<p>the probability of passing the exam as a function of the high-school background</p>
</blockquote>
<ul>
<li class="fragment">each “background” has different students that passed or not the exam (0/1)</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 4 × 4
#&gt;   background nc    nf    nt   
#&gt;   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1 math       20    10    30   
#&gt; 2 chemistry  16    4     20   
#&gt; 3 art        4     6     10   
#&gt; 4 sport      15    5     20</code></pre>
</div>
</div>
<p>Or the binary version:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; # A tibble: 9 × 5
#&gt;   background nc    nf    nt    y    
#&gt;   &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
#&gt; 1 math       20    10    30    1    
#&gt; 2 math       20    10    30    1    
#&gt; 3 math       20    10    30    1    
#&gt; 4 math       20    10    30    1    
#&gt; 5 ...        ...   ...   ...   ...  
#&gt; 6 sport      15    5     20    0    
#&gt; 7 sport      15    5     20    0    
#&gt; 8 sport      15    5     20    0    
#&gt; 9 sport      15    5     20    0</code></pre>
</div>
</div>
</section>
<section id="binomial-vs-binary-type-of-predictors-3" class="slide level2">
<h2>Binomial vs Binary: type of predictors</h2>
<ul>
<li class="fragment">To note that despite we can convert between the binary/binomial, the two models are not always the same. The <em>high-school background example</em> can be easily modelled either with a binary or binomial model because the predictor is at the participant level that coincides with the trial level.</li>
<li class="fragment">On the other side, the <em>question difficulty example</em> can only be modelled using a binary regression because each trial (0/1) has a different value for the predictor</li>
<li class="fragment">To include both predictors or to model multiple participants on the <em>question difficulty example</em> we need a mixed-effects model where both levels together with the repeated-measures can be handled.</li>
<li class="fragment">a very clear overview of this topic can be found here https://www.rensvandeschoot.com/tutorials/generalised-linear-models-with-glm-and-lme4/</li>
</ul>
</section></section>
<section>
<section id="probit-link" class="title-slide slide level1 section">
<h1 class="section">Probit link</h1>

</section>
<section id="probit-link-1" class="slide level2">
<h2>Probit link</h2>
<ul>
<li class="fragment">The mostly used <em>link function</em> when using a binomial GLM is the <strong>logit link</strong>. The <strong>probit</strong> link is another <em>link function</em> that can be used. The overall approach is the same between <strong>logit</strong> and <strong>probit</strong> models. The only difference is the parameter interpretation (i.e., no odds ratios) and the specific link function (and the inverse) to use.</li>
<li class="fragment">The <strong>probit</strong> model use the <strong>cumulative normal distribution</strong> but the actual difference with a <strong>logit</strong> functions is neglegible.</li>
</ul>
</section>
<section id="probit-link-2" class="slide level2">
<h2>Probit link</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-150-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="probit-link-3" class="slide level2">
<h2>Probit link</h2>
<p>When using the <strong>probit link</strong> the parameters are interpreted as difference in <em>z-scores</em> associated with a unit increase in the predictors. In fact probabilities are mapped into <em>z-scores</em> using the cumulative normal distribution.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb217"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qlogis</span>(<span class="fu">c</span>(p1, p2)) <span class="co"># log(odds(p1)), logit link</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.8472979 0.0000000</code></pre>
</div>
<div class="sourceCode" id="cb219"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(p1, p2)) <span class="co"># probit link</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.5244005 0.0000000</code></pre>
</div>
<div class="sourceCode" id="cb221"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">odds_ratio</span>(p1, p2)) <span class="co"># ~ beta1, logit link</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.8472979</code></pre>
</div>
<div class="sourceCode" id="cb223"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(p1) <span class="sc">-</span> <span class="fu">pnorm</span>(p2) <span class="co"># ~beta1, probit link</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; [1] 0.06657389</code></pre>
</div>
</div>
</section>
<section id="probit-link-4" class="slide level2">
<h2>Probit link</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="02-binomial-glm_files/figure-revealjs/unnamed-chunk-152-1.svg" class="quarto-figure quarto-figure-center" width="672" /></p>
</figure>
</div>
</div>
</div>
</section>
<section id="references" class="slide level2">
<h2>References</h2>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW1ldGF0aXRsZQ==">Binomial GLM – Generalized Linear Models</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLXR3aXR0ZXJjYXJkdGl0bGU=">Binomial GLM – Generalized Linear Models</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW9nY2FyZHRpdGxl">Binomial GLM – Generalized Linear Models</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW1ldGFzaXRlbmFtZQ==">Generalized Linear Models</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLXR3aXR0ZXJjYXJkZGVzYw==">Psychological Sciences</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW9nY2FyZGRkZXNj">Psychological Sciences</span></p>
</div>
<div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Agresti2015-cz" class="csl-entry" role="listitem">
Agresti, A. (2015). <em>Foundations of linear and generalized linear models</em>. John Wiley &amp; Sons. <a href="https://play.google.com/store/books/details?id=jlIqBgAAQBAJ">https://play.google.com/store/books/details?id=jlIqBgAAQBAJ</a>
</div>
<div id="ref-Arel-Bundock2024-zl" class="csl-entry" role="listitem">
Arel-Bundock, V., Greifer, N., &amp; Heiss, A. (2024). How to interpret statistical models using marginaleffects for <em>r</em> and <em>python</em>. <em>Journal of Statistical Software</em>, <em>111</em>, 1–32. <a href="https://doi.org/10.18637/jss.v111.i09">https://doi.org/10.18637/jss.v111.i09</a>
</div>
<div id="ref-Borenstein2009-mo" class="csl-entry" role="listitem">
Borenstein, M., Hedges, L. V., Higgins, J. P. T., &amp; Rothstein, H. R. (2009). <em>Introduction to <span>Meta-Analysis</span></em>. <a href="https://doi.org/10.1002/9780470743386">https://doi.org/10.1002/9780470743386</a>
</div>
<div id="ref-Dunn1996-yd" class="csl-entry" role="listitem">
Dunn, P. K., &amp; Smyth, G. K. (1996). Randomized quantile residuals. <em>Journal of Computational and Graphical Statistics: A Joint Publication of American Statistical Association, Institute of Mathematical Statistics, Interface Foundation of North America</em>, <em>5</em>, 236–244. <a href="https://doi.org/10.1080/10618600.1996.10474708">https://doi.org/10.1080/10618600.1996.10474708</a>
</div>
<div id="ref-Dunn2018-ww" class="csl-entry" role="listitem">
Dunn, P. K., &amp; Smyth, G. K. (2018). <em>Generalized linear models with examples in r</em>. Springer. <a href="https://play.google.com/store/books/details?id=tBh5DwAAQBAJ">https://play.google.com/store/books/details?id=tBh5DwAAQBAJ</a>
</div>
<div id="ref-Gelman2006-pc" class="csl-entry" role="listitem">
Gelman, A., &amp; Hill, J. (2006). <em>Data analysis using regression and multilevel/hierarchical models</em>. Cambridge University Press. <a href="https://doi.org/10.1017/CBO9780511790942">https://doi.org/10.1017/CBO9780511790942</a>
</div>
<div id="ref-Gelman2020-tg" class="csl-entry" role="listitem">
Gelman, A., Hill, J., &amp; Vehtari, A. (2020). <em>Regression and other stories</em>. Cambridge University Press. <a href="https://doi.org/10.1017/9781139161879">https://doi.org/10.1017/9781139161879</a>
</div>
<div id="ref-Knoblauch2012-to" class="csl-entry" role="listitem">
Knoblauch, K., &amp; Maloney, L. T. (2012). <em>Modeling psychophysical data in r</em>. Springer New York. <a href="https://doi.org/10.1007/978-1-4614-4475-6">https://doi.org/10.1007/978-1-4614-4475-6</a>
</div>
<div id="ref-McFadden1987-qq" class="csl-entry" role="listitem">
McFadden, D. (1987). Regression-based specification tests for the multinomial logit model. <em>Journal of Econometrics</em>, <em>34</em>, 63–82. <a href="https://doi.org/10.1016/0304-4076(87)90067-4">https://doi.org/10.1016/0304-4076(87)90067-4</a>
</div>
<div id="ref-Sanchez-Meca2003-ji" class="csl-entry" role="listitem">
Sánchez-Meca, J., Marín-Martínez, F., &amp; Chacón-Moscoso, S. (2003). Effect-size indices for dichotomized outcomes in meta-analysis. <em>Psychological Methods</em>, <em>8</em>, 448–467. <a href="https://doi.org/10.1037/1082-989X.8.4.448">https://doi.org/10.1037/1082-989X.8.4.448</a>
</div>
<div id="ref-Tjur2009-ml" class="csl-entry" role="listitem">
Tjur, T. (2009). Coefficients of determination in logistic regression models—a new proposal: The coefficient of discrimination. <em>The American Statistician</em>, <em>63</em>, 366–372. <a href="https://doi.org/10.1198/tast.2009.08210">https://doi.org/10.1198/tast.2009.08210</a>
</div>
</div>
</section></section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p>Thanks to Prof. Paolo Girardi for the example, see https://teddychild.dpss.psy.unipd.it/ for information<a href="#/fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>see also the <a href="https://cran.r-project.org/web/packages/investr/vignettes/introduction.pdf"><code>investr</code></a> package<a href="#/fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Notice that I use <code>2*se</code> instead of the precise quantile of the Gaussian distribution that for <span class="math inline">\(\alpha = 0.05\)</span> is <span class="math inline">\(\sim 1.96\)</span><a href="#/fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Adapted from https://bookdown.org/egarpor/SSS2-UC3M/logreg-deviance.html<a href="#/fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Adapted from Dunn (2018), Fig. 8.1<a href="#/fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>We are using a Poisson model only because the residual pattern is more clear compared to a binomial model<a href="#/fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Note that you are not required to re-fit the model to estimate the DFBETAs, you can use the <span class="math inline">\(H\)</span> matrix, see https://en.wikipedia.org/wiki/Influential_observation<a href="#/fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>The function actually computes also other influence measures, see Dunn (2018, section 8.8.3) for other details<a href="#/fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>To note, the <strong>binned residuals</strong> could be considered as an attempt to mitigate the binary residuals problem by creating bins of fitted/residual values similarly to fitting a binomial model.<a href="#/fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>Thanks to Prof. Altoè for this suggestion<a href="#/fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

<!-- FINAL SLIDE -->

<!-- END FINAL SLIDE -->

    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({ 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [
          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id = "quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    </body>
</html>
