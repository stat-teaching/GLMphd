{
  "hash": "4ab4abc479bddbcfe284e337a9de0be3",
  "result": {
    "markdown": "---\ntitle: \"Lab 5\"\nauthor: \"Filippo Gambarota\"\nformat: html\nembed-resources: true\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndevtools::load_all() # if using the rproject dowloaded from the slides\n# source(\"utils-glm.R\") # if using a standard setup\nlibrary(here)\nlibrary(tidyr) # for data manipulation\nlibrary(dplyr) # for data manipulation\nlibrary(ggplot2) # plotting\nlibrary(car) # general utilities\nlibrary(effects) # for extracting and plotting effects \nlibrary(emmeans) # for marginal means\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"nwords\")\ndat <- nwords\n```\n:::\n\n\n# Overview\n\nThis dataset `nwords` represent a developmental psychology study investigating the factors that influence children language development. The dataset includes information about the number of words in a a language task, and some potential predictors: caregiver behavior, socioeconomic status, amount of time spent with the child during a week and the presence of a baby-sitter or not.\n\n- `child`: numeric variable representing the child ID number.\n- `timebonding`: numeric variable representing the average hours per week of child-parent activities\n- `nwords`: numeric variable representing the number of words produced by the child in a language task.\n- `caregiving`: numeric variable representing the caregiver's behavior in a parent-child interaction task, measured on a scale from 0 to 10\n- `ses`: categorical variable representing the family socioeconomic status, with three levels: \"Low\", \"Middle\", and \"High\"\n\n1. Importing data and overall check\n    - think about factors levels, scale of the numerical variables, etc.\n2. Exploratory data analysis of predictors and the relationships between predictors and the number of words\n3. Model fitting with `glm()` and `poisson` family starting from additive models and then adding the interactions.\n4. Model diagnostic of the chosen model\n    - overdispersion\n    - residuals\n    - outliers and influential points\n5. Interpreting the effects and plotting\n6. Fit a quasi-poisson and negative binomial version of the chosen model, and check how parameters are affected\n\n# 1. Importing data and overall check\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- read.csv(\"data/nwords.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t150 obs. of  6 variables:\n $ id         : int  1 2 3 4 5 6 7 8 9 10 ...\n $ timebonding: num  23 18 20 23 11 5 15 18 29 22 ...\n $ caregiving : num  7 8 7 11 8 5 4 5 14 9 ...\n $ ses        : Factor w/ 3 levels \"low\",\"middle\",..: 1 1 1 1 1 1 1 1 1 1 ...\n  ..- attr(*, \"contrasts\")= num [1:3, 1:2] 0 1 0 0 0 1\n  .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. ..$ : chr [1:3] \"low\" \"middle\" \"high\"\n  .. .. ..$ : chr [1:2] \"2\" \"3\"\n $ babysitter : Factor w/ 2 levels \"no\",\"yes\": 1 1 1 2 1 2 1 2 1 1 ...\n  ..- attr(*, \"contrasts\")= num [1:2, 1] 0 1\n  .. ..- attr(*, \"dimnames\")=List of 2\n  .. .. ..$ : chr [1:2] \"no\" \"yes\"\n  .. .. ..$ : chr \"2\"\n $ nwords     : int  24 20 16 38 14 17 17 35 30 13 ...\n```\n:::\n:::\n\n\nCheck for `NA` values:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsapply(dat, function(x) sum(is.na(x)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         id timebonding  caregiving         ses  babysitter      nwords \n          0           0           0           0           0           0 \n```\n:::\n:::\n\n\nEverything seems good, we do not have `NA` values.\n\nLet's convert categorical variables into factor setting the appropriate order:\n\n- `ses`: low, middle, high\n- `babysitter`: no, yes\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat$ses <- factor(dat$ses, levels = c(\"low\", \"middle\", \"high\"))\ndat$babysitter <- factor(dat$babysitter, levels = c(\"no\", \"yes\"))\n\nlevels(dat$ses)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"low\"    \"middle\" \"high\"  \n```\n:::\n\n```{.r .cell-code}\nlevels(dat$babysitter)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"no\"  \"yes\"\n```\n:::\n:::\n\n\n`timebonding` and `caregiving` are the two numerical predictors. Given that we are going to fit main effects and interactions and we want to interpret the intercept and test the interaction on a meaningful point, we create two centered versions of these variables:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat$timebonding0 <- dat$timebonding - mean(dat$timebonding)\ndat$caregiving0 <- dat$caregiving - mean(dat$caregiving)\n```\n:::\n\n\nThen we can see what happen to the variables:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncols <- grepl(\"timebonding|caregiving\", names(dat))\nlapply(dat[, cols], function(x) round(c(mean = mean(x), sd = sd(x)), 3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$timebonding\n  mean     sd \n14.807  8.736 \n\n$caregiving\n mean    sd \n5.420 2.841 \n\n$timebonding0\n mean    sd \n0.000 8.736 \n\n$caregiving0\n mean    sd \n0.000 2.841 \n```\n:::\n:::\n\n\n# 2. Exploratory data analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(dat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       id          timebonding      caregiving        ses     babysitter\n Min.   :  1.00   Min.   : 0.00   Min.   : 0.00   low   :45   no :83    \n 1st Qu.: 38.25   1st Qu.: 8.00   1st Qu.: 4.00   middle:75   yes:67    \n Median : 75.50   Median :14.00   Median : 5.00   high  :30             \n Mean   : 75.50   Mean   :14.81   Mean   : 5.42                         \n 3rd Qu.:112.75   3rd Qu.:21.00   3rd Qu.: 7.00                         \n Max.   :150.00   Max.   :37.00   Max.   :14.00                         \n     nwords       timebonding0       caregiving0   \n Min.   : 2.00   Min.   :-14.8067   Min.   :-5.42  \n 1st Qu.:10.00   1st Qu.: -6.8067   1st Qu.:-1.42  \n Median :17.00   Median : -0.8067   Median :-0.42  \n Mean   :19.96   Mean   :  0.0000   Mean   : 0.00  \n 3rd Qu.:27.00   3rd Qu.:  6.1933   3rd Qu.: 1.58  \n Max.   :54.00   Max.   : 22.1933   Max.   : 8.58  \n```\n:::\n:::\n\n\nLet's do some plotting of predictors:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,2))\nhist(dat$timebonding)\nhist(dat$caregiving)\nbarplot(table(dat$babysitter))\nbarplot(table(dat$ses))\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-8-1.svg){width=672}\n:::\n:::\n\n\nComments?\n\nAlso the response variable:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(dat$nwords, probability = TRUE)\nlines(density(dat$nwords), col = \"salmon\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-9-1.svg){width=672}\n:::\n:::\n\n\nLet's plot the theoretical distributions, Poisson and Gaussian:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm <- mean(dat$nwords)\ns <- sd(dat$nwords)\nxs <- seq(0, 50, 1)\n\nhist(dat$nwords, probability = TRUE, xlim = c(-10, 50), ylim = c(0, 0.1))\ncurve(dnorm(x, m, s), add = TRUE, col = \"green\", lwd = 2)\nlines(xs, dpois(xs, m), col = \"red\", lwd = 2)\nlines(xs, dpois(xs, m), col = \"red\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-10-1.svg){width=672}\n:::\n:::\n\n\nComments?\n\nLet's plot some bivariate distributions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# caregiving ~ timebonding\nr <- cor(dat$timebonding, dat$caregiving)\nplot(dat$timebonding, dat$caregiving, pch = 19)\nabline(lm(dat$caregiving ~ dat$timebonding), col = \"red\", lwd = 2)\ntext(30, 2, label = paste(\"r =\", round(r, 2)))\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-11-1.svg){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1,2))\nboxplot(caregiving ~ ses, data = dat)\nboxplot(timebonding ~ ses, data = dat)\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-12-1.svg){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmosaicplot(table(dat$ses, dat$babysitter))\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-13-1.svg){width=672}\n:::\n\n```{.r .cell-code}\n# or\nbarplot(table(dat$babysitter, dat$ses), col = c(\"red\", \"green\"), beside = TRUE)\nlegend(7,45, legend = c(\"no\", \"yes\"), fill = c(\"red\", \"green\"))\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-13-2.svg){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1,2))\nboxplot(caregiving ~ babysitter, data = dat)\nboxplot(timebonding ~ babysitter, data = dat)\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-14-1.svg){width=672}\n:::\n:::\n\n\nThen the relationships with the `nwords` variable:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,2))\nplot(dat$timebonding, dat$nwords, pch = 19)\nplot(dat$caregiving, dat$nwords, pch = 19)\nboxplot(dat$nwords ~ dat$ses)\nboxplot(dat$nwords ~ dat$babysitter)\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-15-1.svg){width=672}\n:::\n:::\n\n\nComments?\n\nFinally some interactions plot (with `lm`):\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,1))\ncolors <- c(low = \"red\", middle = \"blue\", high = \"green\")\nplot(dat$timebonding, dat$nwords, col = colors[dat$ses], pch = 19)\nlms <- lapply(split(dat, dat$ses), function(x) lm(nwords ~ timebonding, data = x))\nlapply(1:length(lms), function(i) abline(lms[[i]], col = colors[i], lwd = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nNULL\n\n[[2]]\nNULL\n\n[[3]]\nNULL\n```\n:::\n\n```{.r .cell-code}\nplot(dat$caregiving, dat$nwords, col = colors[dat$ses], pch = 19)\nlms <- lapply(split(dat, dat$ses), function(x) lm(nwords ~ caregiving, data = x))\nlapply(1:length(lms), function(i) abline(lms[[i]], col = colors[i], lwd = 2))\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-16-1.svg){width=960}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nNULL\n\n[[2]]\nNULL\n\n[[3]]\nNULL\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,1))\ncolors <- c(no = \"orange\", yes = \"purple\")\n\nplot(dat$timebonding, dat$nwords, col = colors[dat$babysitter], pch = 19)\nlms <- lapply(split(dat, dat$babysitter), function(x) lm(nwords ~ timebonding, data = x))\nlapply(1:length(lms), function(i) abline(lms[[i]], col = colors[i], lwd = 2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nNULL\n\n[[2]]\nNULL\n```\n:::\n\n```{.r .cell-code}\nplot(dat$caregiving, dat$nwords, col = colors[dat$babysitter], pch = 19)\nlms <- lapply(split(dat, dat$babysitter), function(x) lm(nwords ~ caregiving, data = x))\nlapply(1:length(lms), function(i) abline(lms[[i]], col = colors[i], lwd = 2))\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-17-1.svg){width=960}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\nNULL\n\n[[2]]\nNULL\n```\n:::\n:::\n\n\n# 3. Model fitting with `glm()` and `poisson`\n\nLet's start by using an additive model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- glm(nwords ~ timebonding + caregiving + babysitter + ses, family = poisson(link = \"log\"), data = dat)\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nwords ~ timebonding + caregiving + babysitter + \n    ses, family = poisson(link = \"log\"), data = dat)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-4.5942  -1.8861  -0.1598   1.1563   5.2008  \n\nCoefficients:\n              Estimate Std. Error z value Pr(>|z|)    \n(Intercept)    2.38233    0.08162  29.187  < 2e-16 ***\ntimebonding    0.02468    0.00298   8.283  < 2e-16 ***\ncaregiving     0.04572    0.01139   4.014 5.97e-05 ***\nbabysitteryes -0.05342    0.04051  -1.319    0.187    \nsesmiddle     -0.03297    0.04910  -0.672    0.502    \nseshigh       -0.11921    0.08057  -1.480    0.139    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 1074.54  on 149  degrees of freedom\nResidual deviance:  703.21  on 144  degrees of freedom\nAIC: 1411.1\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n\nAnd always plotting before anything else:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(allEffects(fit))\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-19-1.svg){width=672}\n:::\n:::\n\n\nComments? How could you describe the results? Something different from the descriptive statistics?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar::residualPlots(fit)\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-20-1.svg){width=960}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n            Test stat Pr(>|Test stat|)   \ntimebonding    8.4288         0.003693 **\ncaregiving     6.5550         0.010459 * \nbabysitter                               \nses                                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nComments? Are we missing something?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat |> \n    ggplot(aes(x = timebonding, y = nwords, color = ses)) +\n    geom_point() +\n    stat_smooth(method = \"glm\", method.args = list(family = poisson()), se = FALSE)\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-21-1.svg){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat |> \n    ggplot(aes(x = caregiving, y = nwords, color = ses)) +\n    geom_point() +\n    stat_smooth(method = \"glm\", method.args = list(family = poisson()), se = FALSE)\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-22-1.svg){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat |> \n    ggplot(aes(x = timebonding, y = nwords, color = babysitter)) +\n    geom_point() +\n    stat_smooth(method = \"glm\", method.args = list(family = poisson()), se = FALSE)\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-23-1.svg){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat |> \n    ggplot(aes(x = caregiving, y = nwords, color = babysitter)) +\n    geom_point() +\n    stat_smooth(method = \"glm\", method.args = list(family = poisson()), se = FALSE)\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-24-1.svg){width=672}\n:::\n:::\n\n\nLet's add some interactions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit2 <- glm(nwords ~ timebonding*ses + caregiving*ses + timebonding*babysitter + caregiving*babysitter, family = poisson(link = \"log\"), data = dat)\nsummary(fit2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = nwords ~ timebonding * ses + caregiving * ses + \n    timebonding * babysitter + caregiving * babysitter, family = poisson(link = \"log\"), \n    data = dat)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-5.0744  -1.7914  -0.2072   1.2771   5.1336  \n\nCoefficients:\n                           Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                2.449904   0.130572  18.763  < 2e-16 ***\ntimebonding                0.025282   0.005037   5.020 5.18e-07 ***\nsesmiddle                 -0.118244   0.147663  -0.801   0.4233    \nseshigh                   -0.731529   0.172366  -4.244 2.20e-05 ***\ncaregiving                 0.036904   0.019566   1.886   0.0593 .  \nbabysitteryes              0.208781   0.106645   1.958   0.0503 .  \ntimebonding:sesmiddle      0.012661   0.006201   2.042   0.0412 *  \ntimebonding:seshigh        0.057886   0.012124   4.775 1.80e-06 ***\nsesmiddle:caregiving      -0.026875   0.024638  -1.091   0.2754    \nseshigh:caregiving        -0.027161   0.039418  -0.689   0.4908    \ntimebonding:babysitteryes -0.029552   0.006247  -4.731 2.24e-06 ***\ncaregiving:babysitteryes   0.039355   0.019464   2.022   0.0432 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 1074.54  on 149  degrees of freedom\nResidual deviance:  654.95  on 138  degrees of freedom\nAIC: 1374.8\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(allEffects(fit2))\n```\n\n::: {.cell-output-display}\n![](lab5_files/figure-html/unnamed-chunk-26-1.svg){width=960}\n:::\n:::\n\n\n# 4. Model fitting with `MASS::glm.nb()`\n\nThere is still evidence for overdispersion, even after including all predictors and a series of interactions. Let's assume that this is our most complex model, we need to take into account the overdispersion:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nperformance::check_overdispersion(fit2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Overdispersion test\n\n       dispersion ratio =   4.710\n  Pearson's Chi-Squared = 649.938\n                p-value = < 0.001\n```\n:::\n\n```{.r .cell-code}\nfit3 <- MASS::glm.nb(nwords ~ timebonding*ses + caregiving*ses + timebonding*babysitter + caregiving*babysitter, data = dat)\n\nsummary(fit3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nMASS::glm.nb(formula = nwords ~ timebonding * ses + caregiving * \n    ses + timebonding * babysitter + caregiving * babysitter, \n    data = dat, init.theta = 5.511283984, link = log)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-2.3222  -0.8568  -0.1203   0.5893   2.0347  \n\nCoefficients:\n                          Estimate Std. Error z value Pr(>|z|)    \n(Intercept)                2.42447    0.30858   7.857 3.94e-15 ***\ntimebonding                0.02188    0.01220   1.793   0.0729 .  \nsesmiddle                 -0.12795    0.33725  -0.379   0.7044    \nseshigh                   -0.65153    0.35611  -1.830   0.0673 .  \ncaregiving                 0.04869    0.04756   1.024   0.3060    \nbabysitteryes              0.20747    0.20566   1.009   0.3131    \ntimebonding:sesmiddle      0.01417    0.01450   0.978   0.3282    \ntimebonding:seshigh        0.05378    0.02394   2.246   0.0247 *  \nsesmiddle:caregiving      -0.02627    0.05691  -0.462   0.6444    \nseshigh:caregiving        -0.03298    0.08127  -0.406   0.6849    \ntimebonding:babysitteryes -0.02536    0.01392  -1.822   0.0684 .  \ncaregiving:babysitteryes   0.02732    0.04305   0.635   0.5257    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for Negative Binomial(5.5113) family taken to be 1)\n\n    Null deviance: 249.03  on 149  degrees of freedom\nResidual deviance: 154.97  on 138  degrees of freedom\nAIC: 1093\n\nNumber of Fisher Scoring iterations: 1\n\n              Theta:  5.511 \n          Std. Err.:  0.835 \n\n 2 x log-likelihood:  -1066.951 \n```\n:::\n:::\n\n\nNow overdispersion is taken into account and standard errors are larger:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncar::compareCoefs(fit2, fit3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCalls:\n1: glm(formula = nwords ~ timebonding * ses + caregiving * ses + \n  timebonding * babysitter + caregiving * babysitter, family = poisson(link = \n  \"log\"), data = dat)\n2: MASS::glm.nb(formula = nwords ~ timebonding * ses + caregiving * ses + \n  timebonding * babysitter + caregiving * babysitter, data = dat, init.theta =\n   5.511283984, link = log)\n\n                           Model 1  Model 2\n(Intercept)                  2.450    2.424\nSE                           0.131    0.309\n                                           \ntimebonding                0.02528  0.02188\nSE                         0.00504  0.01220\n                                           \nsesmiddle                   -0.118   -0.128\nSE                           0.148    0.337\n                                           \nseshigh                     -0.732   -0.652\nSE                           0.172    0.356\n                                           \ncaregiving                  0.0369   0.0487\nSE                          0.0196   0.0476\n                                           \nbabysitteryes                0.209    0.207\nSE                           0.107    0.206\n                                           \ntimebonding:sesmiddle       0.0127   0.0142\nSE                          0.0062   0.0145\n                                           \ntimebonding:seshigh         0.0579   0.0538\nSE                          0.0121   0.0239\n                                           \nsesmiddle:caregiving       -0.0269  -0.0263\nSE                          0.0246   0.0569\n                                           \nseshigh:caregiving         -0.0272  -0.0330\nSE                          0.0394   0.0813\n                                           \ntimebonding:babysitteryes -0.02955 -0.02536\nSE                         0.00625  0.01392\n                                           \ncaregiving:babysitteryes    0.0394   0.0273\nSE                          0.0195   0.0431\n                                           \n```\n:::\n\n```{.r .cell-code}\n# test statistics for the poisson model\n\ndata.frame(\n    poisson = fit2$coefficients/sqrt(diag(vcov(fit2))),\n    negative_binomial = fit3$coefficients/sqrt(diag(vcov(fit3)))\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                             poisson negative_binomial\n(Intercept)               18.7628976         7.8567464\ntimebonding                5.0195056         1.7932210\nsesmiddle                 -0.8007732        -0.3794009\nseshigh                   -4.2440539        -1.8295760\ncaregiving                 1.8861966         1.0237380\nbabysitteryes              1.9577133         1.0087898\ntimebonding:sesmiddle      2.0417940         0.9777883\ntimebonding:seshigh        4.7746326         2.2463830\nsesmiddle:caregiving      -1.0907766        -0.4615336\nseshigh:caregiving        -0.6890598        -0.4057725\ntimebonding:babysitteryes -4.7305937        -1.8221897\ncaregiving:babysitteryes   2.0219802         0.6345467\n```\n:::\n:::\n",
    "supporting": [
      "lab5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}