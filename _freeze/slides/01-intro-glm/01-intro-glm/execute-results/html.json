{
  "hash": "5c98eed3bad44505006094ddeeabdfb8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Introduction to Generalized Linear Models\nbibliography: \"https://raw.githubusercontent.com/filippogambarota/bib-database/main/references.bib\"\ncsl: \"https://raw.githubusercontent.com/citation-style-language/styles/master/apa.csl\"\nnocite: |\n  @Gelman2020-tg, @Agresti2018-oh, @Agresti2015-cz, @Dunn2018-ww, @Fox2015-ps, @Faraway2016-py\n---\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Beyond the Gaussian distribution {.section}\n\n## Quick recap about Gaussian distribution\n\n- The Gaussian distribution is part of the **Exponential family**\n- It is defined with mean ($\\mu$) and the standard deviation ($\\sigma$)\n- It is symmetric (mean, mode and median are the same)\n- The support is $[- \\infty, + \\infty]$\n\n. . .\n\nThe Probability Density Function (PDF) is:\n\n$$\nf(x, \\mu, \\sigma) = \\frac{1}{\\sigma\\sqrt{2\\pi}} e^{-\\frac{1}{2}(\\frac{x - \\mu}{\\sigma})^2}\n$$\n\n## Quick recap about Gaussian distribution\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-4-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Quick recap about Gaussian distribution\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-5-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n\\begin{center}\nBut not always gaussian-like variables!\n\\end{center}\n\n## But...\n\nIn Psychology, variables do not always satisfy the properties of the Gaussian distribution. For example:\n\n- Reaction times\n- Percentages or proportions (e.g., task accuracy)\n- Counts\n- Likert scales\n- ...\n\n## Reaction times\n\nNon-negative and probably skewed data:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-6-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Binary outcomes\n\nA series of binary (i.e., *bernoulli*) trials with two possible outcomes:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-7-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Counts\n\nNumber of symptoms for a group of patients during the last month:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-8-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n# Should we use a linear model for these variables? {.question}\n\n## Should we use a linear model for these variables?\n\nExample: probability of passing the exam as a function of hours of study:\n\n::: columns\n:::: column\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"hukxqmtqpt\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#hukxqmtqpt table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#hukxqmtqpt thead, #hukxqmtqpt tbody, #hukxqmtqpt tfoot, #hukxqmtqpt tr, #hukxqmtqpt td, #hukxqmtqpt th {\n  border-style: none;\n}\n\n#hukxqmtqpt p {\n  margin: 0;\n  padding: 0;\n}\n\n#hukxqmtqpt .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#hukxqmtqpt .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#hukxqmtqpt .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#hukxqmtqpt .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#hukxqmtqpt .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hukxqmtqpt .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hukxqmtqpt .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#hukxqmtqpt .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#hukxqmtqpt .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#hukxqmtqpt .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#hukxqmtqpt .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#hukxqmtqpt .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#hukxqmtqpt .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#hukxqmtqpt .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#hukxqmtqpt .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#hukxqmtqpt .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#hukxqmtqpt .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#hukxqmtqpt .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#hukxqmtqpt .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hukxqmtqpt .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#hukxqmtqpt .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#hukxqmtqpt .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#hukxqmtqpt .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hukxqmtqpt .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#hukxqmtqpt .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#hukxqmtqpt .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hukxqmtqpt .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hukxqmtqpt .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#hukxqmtqpt .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hukxqmtqpt .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#hukxqmtqpt .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#hukxqmtqpt .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hukxqmtqpt .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hukxqmtqpt .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#hukxqmtqpt .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#hukxqmtqpt .gt_left {\n  text-align: left;\n}\n\n#hukxqmtqpt .gt_center {\n  text-align: center;\n}\n\n#hukxqmtqpt .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#hukxqmtqpt .gt_font_normal {\n  font-weight: normal;\n}\n\n#hukxqmtqpt .gt_font_bold {\n  font-weight: bold;\n}\n\n#hukxqmtqpt .gt_font_italic {\n  font-style: italic;\n}\n\n#hukxqmtqpt .gt_super {\n  font-size: 65%;\n}\n\n#hukxqmtqpt .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#hukxqmtqpt .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#hukxqmtqpt .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#hukxqmtqpt .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#hukxqmtqpt .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#hukxqmtqpt .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#hukxqmtqpt .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"id\">id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"studyh\">studyh</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"passed\">passed</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"1\"><div class='gt_from_md'><p>1</p>\n</div></div></td>\n<td headers=\"studyh\" class=\"gt_row gt_center\"><div data-qmd=\"93\"><div class='gt_from_md'><p>93</p>\n</div></div></td>\n<td headers=\"passed\" class=\"gt_row gt_center\"><div data-qmd=\"1\"><div class='gt_from_md'><p>1</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"2\"><div class='gt_from_md'><p>2</p>\n</div></div></td>\n<td headers=\"studyh\" class=\"gt_row gt_center\"><div data-qmd=\"66\"><div class='gt_from_md'><p>66</p>\n</div></div></td>\n<td headers=\"passed\" class=\"gt_row gt_center\"><div data-qmd=\"0\"><div class='gt_from_md'><p>0</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"3\"><div class='gt_from_md'><p>3</p>\n</div></div></td>\n<td headers=\"studyh\" class=\"gt_row gt_center\"><div data-qmd=\"57\"><div class='gt_from_md'><p>57</p>\n</div></div></td>\n<td headers=\"passed\" class=\"gt_row gt_center\"><div data-qmd=\"1\"><div class='gt_from_md'><p>1</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"4\"><div class='gt_from_md'><p>4</p>\n</div></div></td>\n<td headers=\"studyh\" class=\"gt_row gt_center\"><div data-qmd=\"23\"><div class='gt_from_md'><p>23</p>\n</div></div></td>\n<td headers=\"passed\" class=\"gt_row gt_center\"><div data-qmd=\"0\"><div class='gt_from_md'><p>0</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"...\"><div class='gt_from_md'><p>…</p>\n</div></div></td>\n<td headers=\"studyh\" class=\"gt_row gt_center\"><div data-qmd=\"...\"><div class='gt_from_md'><p>…</p>\n</div></div></td>\n<td headers=\"passed\" class=\"gt_row gt_center\"><div data-qmd=\"...\"><div class='gt_from_md'><p>…</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"47\"><div class='gt_from_md'><p>47</p>\n</div></div></td>\n<td headers=\"studyh\" class=\"gt_row gt_center\"><div data-qmd=\"84\"><div class='gt_from_md'><p>84</p>\n</div></div></td>\n<td headers=\"passed\" class=\"gt_row gt_center\"><div data-qmd=\"0\"><div class='gt_from_md'><p>0</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"48\"><div class='gt_from_md'><p>48</p>\n</div></div></td>\n<td headers=\"studyh\" class=\"gt_row gt_center\"><div data-qmd=\"61\"><div class='gt_from_md'><p>61</p>\n</div></div></td>\n<td headers=\"passed\" class=\"gt_row gt_center\"><div data-qmd=\"0\"><div class='gt_from_md'><p>0</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"49\"><div class='gt_from_md'><p>49</p>\n</div></div></td>\n<td headers=\"studyh\" class=\"gt_row gt_center\"><div data-qmd=\"23\"><div class='gt_from_md'><p>23</p>\n</div></div></td>\n<td headers=\"passed\" class=\"gt_row gt_center\"><div data-qmd=\"0\"><div class='gt_from_md'><p>0</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"50\"><div class='gt_from_md'><p>50</p>\n</div></div></td>\n<td headers=\"studyh\" class=\"gt_row gt_center\"><div data-qmd=\"58\"><div class='gt_from_md'><p>58</p>\n</div></div></td>\n<td headers=\"passed\" class=\"gt_row gt_center\"><div data-qmd=\"1\"><div class='gt_from_md'><p>1</p>\n</div></div></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n::::\n:::: column\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\ndat |> \n  summarise(n = n(),\n            npass = sum(passed),\n            nfail = n - npass,\n            ppass = npass / n)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 1 × 4\n#>       n npass nfail ppass\n#>   <int> <int> <int> <dbl>\n#> 1    50    18    32  0.36\n```\n\n\n:::\n:::\n\n\n\n::::\n:::\n\n## Should we use a linear model for these variables?\n\nLet's plot the data:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-11-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Should we use a linear model for these variables?\n\nLet's fit a linear model `passing ~ study_hours` using `lm`:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-12-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n. . .\n\n**Do you see something strange?**\n\n## Should we use a linear model for these variables?\n\nA little **spoiler**, the relationship should be probably like this:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-13-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Should we use a linear model for these variables?\n\nAnother example, the number of solved exercises in a semester as a function of the number of attended lectures ($N = 100$):\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"ugxanedbes\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#ugxanedbes table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#ugxanedbes thead, #ugxanedbes tbody, #ugxanedbes tfoot, #ugxanedbes tr, #ugxanedbes td, #ugxanedbes th {\n  border-style: none;\n}\n\n#ugxanedbes p {\n  margin: 0;\n  padding: 0;\n}\n\n#ugxanedbes .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#ugxanedbes .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#ugxanedbes .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#ugxanedbes .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#ugxanedbes .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ugxanedbes .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ugxanedbes .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#ugxanedbes .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#ugxanedbes .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#ugxanedbes .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#ugxanedbes .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#ugxanedbes .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#ugxanedbes .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#ugxanedbes .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#ugxanedbes .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#ugxanedbes .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#ugxanedbes .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#ugxanedbes .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#ugxanedbes .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ugxanedbes .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#ugxanedbes .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#ugxanedbes .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#ugxanedbes .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ugxanedbes .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#ugxanedbes .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#ugxanedbes .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ugxanedbes .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ugxanedbes .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#ugxanedbes .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ugxanedbes .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#ugxanedbes .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#ugxanedbes .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ugxanedbes .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ugxanedbes .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#ugxanedbes .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#ugxanedbes .gt_left {\n  text-align: left;\n}\n\n#ugxanedbes .gt_center {\n  text-align: center;\n}\n\n#ugxanedbes .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#ugxanedbes .gt_font_normal {\n  font-weight: normal;\n}\n\n#ugxanedbes .gt_font_bold {\n  font-weight: bold;\n}\n\n#ugxanedbes .gt_font_italic {\n  font-style: italic;\n}\n\n#ugxanedbes .gt_super {\n  font-size: 65%;\n}\n\n#ugxanedbes .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#ugxanedbes .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#ugxanedbes .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#ugxanedbes .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#ugxanedbes .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#ugxanedbes .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#ugxanedbes .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"id\">id</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"nattended\">nattended</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"nsolved\">nsolved</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"1\"><div class='gt_from_md'><p>1</p>\n</div></div></td>\n<td headers=\"nattended\" class=\"gt_row gt_center\"><div data-qmd=\"18\"><div class='gt_from_md'><p>18</p>\n</div></div></td>\n<td headers=\"nsolved\" class=\"gt_row gt_center\"><div data-qmd=\"3\"><div class='gt_from_md'><p>3</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"2\"><div class='gt_from_md'><p>2</p>\n</div></div></td>\n<td headers=\"nattended\" class=\"gt_row gt_center\"><div data-qmd=\"20\"><div class='gt_from_md'><p>20</p>\n</div></div></td>\n<td headers=\"nsolved\" class=\"gt_row gt_center\"><div data-qmd=\"1\"><div class='gt_from_md'><p>1</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"3\"><div class='gt_from_md'><p>3</p>\n</div></div></td>\n<td headers=\"nattended\" class=\"gt_row gt_center\"><div data-qmd=\"35\"><div class='gt_from_md'><p>35</p>\n</div></div></td>\n<td headers=\"nsolved\" class=\"gt_row gt_center\"><div data-qmd=\"5\"><div class='gt_from_md'><p>5</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"4\"><div class='gt_from_md'><p>4</p>\n</div></div></td>\n<td headers=\"nattended\" class=\"gt_row gt_center\"><div data-qmd=\"8\"><div class='gt_from_md'><p>8</p>\n</div></div></td>\n<td headers=\"nsolved\" class=\"gt_row gt_center\"><div data-qmd=\"0\"><div class='gt_from_md'><p>0</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"...\"><div class='gt_from_md'><p>…</p>\n</div></div></td>\n<td headers=\"nattended\" class=\"gt_row gt_center\"><div data-qmd=\"...\"><div class='gt_from_md'><p>…</p>\n</div></div></td>\n<td headers=\"nsolved\" class=\"gt_row gt_center\"><div data-qmd=\"...\"><div class='gt_from_md'><p>…</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"97\"><div class='gt_from_md'><p>97</p>\n</div></div></td>\n<td headers=\"nattended\" class=\"gt_row gt_center\"><div data-qmd=\"45\"><div class='gt_from_md'><p>45</p>\n</div></div></td>\n<td headers=\"nsolved\" class=\"gt_row gt_center\"><div data-qmd=\"4\"><div class='gt_from_md'><p>4</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"98\"><div class='gt_from_md'><p>98</p>\n</div></div></td>\n<td headers=\"nattended\" class=\"gt_row gt_center\"><div data-qmd=\"28\"><div class='gt_from_md'><p>28</p>\n</div></div></td>\n<td headers=\"nsolved\" class=\"gt_row gt_center\"><div data-qmd=\"4\"><div class='gt_from_md'><p>4</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"99\"><div class='gt_from_md'><p>99</p>\n</div></div></td>\n<td headers=\"nattended\" class=\"gt_row gt_center\"><div data-qmd=\"52\"><div class='gt_from_md'><p>52</p>\n</div></div></td>\n<td headers=\"nsolved\" class=\"gt_row gt_center\"><div data-qmd=\"12\"><div class='gt_from_md'><p>12</p>\n</div></div></td></tr>\n    <tr><td headers=\"id\" class=\"gt_row gt_center\"><div data-qmd=\"100\"><div class='gt_from_md'><p>100</p>\n</div></div></td>\n<td headers=\"nattended\" class=\"gt_row gt_center\"><div data-qmd=\"54\"><div class='gt_from_md'><p>54</p>\n</div></div></td>\n<td headers=\"nsolved\" class=\"gt_row gt_center\"><div data-qmd=\"13\"><div class='gt_from_md'><p>13</p>\n</div></div></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n## Should we use a linear model for these variables?\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-15-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Should we use a linear model for these variables?\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-16-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Should we use a linear model for these variables?\n\nAgain, fitting the linear model seems partially appropriate but there are some problems:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-17-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Should we use a linear model for these variables?\n\nAgain, fitting the linear model seems partially appropriate but there are some problems:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-18-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Should we use a linear model for these variables?\n\nAlso the residuals are quite problematic:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-19-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Should we use a linear model for these variables?\n\nAnother little spoiler, the model should consider both the support of the `y` variable and the non-linear pattern. Probably something like this:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-20-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## So what?\n\nBoth linear models **somehow capture the expected relationship** but there are **serious fitting problems**:\n\n- impossible predictions\n- poor fitting for non-linear patterns\n- linear regression assumptions not respected\n\n. . .\n\nAs a general rule in ~~life~~ statistics:\n\n> All models are wrong, some are useful\n\n## We need a new class of models...\n\n- Taking into account the **specific features of our response variable**\n- Working on a **linear scale** when fitting the model and for inference\n- We need a model that is **closer to the true data generation process**\n\n# Generalized Linear Models  {.section}\n\n## Main references\n\nFor a detailed introduction about GLMs\n\nChapters: 1 (intro), 4 (GLM fitting), 5 (GLM for binary data)\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/agresti2015-foundations-lm-glm.jpg){fig-align='center' width=30%}\n:::\n:::\n\n\n\n## Main references\n\nFor a basic and well written introduction about GLM, especially the Binomial GLM\n\nChapters: 3 (intro GLMs), 4-5 (Binomial Logistic Regression)\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/agresti2019-intro-to-categorical.jpg){fig-align='center' width=50%}\n:::\n:::\n\n\n\n## Main references\n\nGreat resource for interpreting Binomial GLM parameters:\n\nChapters: 13-14 (Binomial Logistic GLM), 15 (Poisson and others GLMs)\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/gelman2020-reg-and-other-stories.jpg){fig-align='center' width=30%}\n:::\n:::\n\n\n\n## Main references\n\nDetailed GLMs book. Very useful especially for the diagnostic part:\n\nChapters: 8 (intro), 9 (Binomial GLM), 10 (Poisson GLM and overdispersion)\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/dunn2018-glm.jpg){fig-align='center' width=30%}\n:::\n:::\n\n\n\n## Main references\n\nThe holy book :)\n\nChapters: 14 and 15\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/fox2015-applied-glm.jpg){fig-align='center' width=30%}\n:::\n:::\n\n\n\n## Main references\n\nAnother good reference...\n\nChapters: 8\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](img/faraway2016-extending-glm.jpg){fig-align='center' width=30%}\n:::\n:::\n\n\n\n## General idea\n\n- using distributions **beyond the Gaussian**\n- modeling **non linear functions** on the response scale\n- taking into account **mean-variance relationships**\n\n## Recipe for a GLM\n\n- **Random Component**\n- **Systematic Component**\n- **Link Function**\n\n## Random Component\n\nThe **random component** of a GLM identify the response variable $y$ coming from a certain probability distribution.\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-27-1.svg){fig-align='center' width=50%}\n:::\n:::\n\n\n\n## Systematic Component\n\nThe **systematic component** or *linear predictor* ($\\eta$) of a GLM is:\n\n$$\n\\eta_i = \\beta_0 + \\beta_1 x_{i1} + \\beta_2 x_{i2} + \\cdots + \\beta_p x_{ip}\n$$\n\nThis part is invariant to the type of model and is the combination of explanatory variables to predict the expected value $\\mu$ (i.e. the mean) of the distribution.\n\n## Link Function\n\nThe **link function** $g(\\mu)$ is an **invertible** function that connects the mean $\\mu$ of the random component with the *linear combination* of predictors.\n\n$g(\\mu) = \\beta_0 + \\beta_1x_{1i} + ... + \\beta_px_{pi}$. The inverse of the link function $g^{-1}$ map the linear predictor ($\\eta$) into the original scale.\n\n$$\ng(\\mu_i) = \\eta_i = \\beta_0 + \\beta_1 x_{i1} + \\beta_2 x_{i2} + \\cdots + \\beta_p x_{ip}\n$$\n\n$$\n\\mu_i = g(\\eta_i)^{-1} = \\eta_i = \\beta_0 + \\beta_1 x_{i1} + \\beta_2 x_{i2} + \\cdots + \\beta_p x_{ip}\n$$\n\nThus, the relationship between $\\mu$ and $\\eta$ is linear only when the **link function ** is applied i.e. $g(\\mu) = \\eta$. \n\n## Link function\n\nThe simplest **link function** is the **identity link** where $g(\\mu) = \\mu$ and correspond to the standard linear model. In fact, the linear regression is just a GLM with a **Gaussian random component** and the **identity** link function.\n\n\n\n::: {.cell layout-align=\"center\" tbl-cap='Main distributions and link functions'}\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"gsvlmmficc\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#gsvlmmficc table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#gsvlmmficc thead, #gsvlmmficc tbody, #gsvlmmficc tfoot, #gsvlmmficc tr, #gsvlmmficc td, #gsvlmmficc th {\n  border-style: none;\n}\n\n#gsvlmmficc p {\n  margin: 0;\n  padding: 0;\n}\n\n#gsvlmmficc .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#gsvlmmficc .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#gsvlmmficc .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#gsvlmmficc .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#gsvlmmficc .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gsvlmmficc .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gsvlmmficc .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#gsvlmmficc .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#gsvlmmficc .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#gsvlmmficc .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#gsvlmmficc .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#gsvlmmficc .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#gsvlmmficc .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#gsvlmmficc .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#gsvlmmficc .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#gsvlmmficc .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#gsvlmmficc .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#gsvlmmficc .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#gsvlmmficc .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gsvlmmficc .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#gsvlmmficc .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#gsvlmmficc .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#gsvlmmficc .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gsvlmmficc .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#gsvlmmficc .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#gsvlmmficc .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gsvlmmficc .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gsvlmmficc .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#gsvlmmficc .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gsvlmmficc .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#gsvlmmficc .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#gsvlmmficc .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gsvlmmficc .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gsvlmmficc .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#gsvlmmficc .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#gsvlmmficc .gt_left {\n  text-align: left;\n}\n\n#gsvlmmficc .gt_center {\n  text-align: center;\n}\n\n#gsvlmmficc .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#gsvlmmficc .gt_font_normal {\n  font-weight: normal;\n}\n\n#gsvlmmficc .gt_font_bold {\n  font-weight: bold;\n}\n\n#gsvlmmficc .gt_font_italic {\n  font-style: italic;\n}\n\n#gsvlmmficc .gt_super {\n  font-size: 65%;\n}\n\n#gsvlmmficc .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#gsvlmmficc .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#gsvlmmficc .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#gsvlmmficc .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#gsvlmmficc .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#gsvlmmficc .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#gsvlmmficc .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"Family\">Family</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"Link\">Link</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" style=\"font-weight: bold;\" scope=\"col\" id=\"Range\">Range</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Family\" class=\"gt_row gt_center\"><div data-qmd=\"`gaussian`\"><div class='gt_from_md'><p><code>gaussian</code></p>\n</div></div></td>\n<td headers=\"Link\" class=\"gt_row gt_center\"><div data-qmd=\"identity\"><div class='gt_from_md'><p>identity</p>\n</div></div></td>\n<td headers=\"Range\" class=\"gt_row gt_center\"><div data-qmd=\"$$(-\\infty,+\\infty)$$\"><div class='gt_from_md'><p>$$(-\\infty,+\\infty)$$</p>\n</div></div></td></tr>\n    <tr><td headers=\"Family\" class=\"gt_row gt_center\"><div data-qmd=\"`gamma`\"><div class='gt_from_md'><p><code>gamma</code></p>\n</div></div></td>\n<td headers=\"Link\" class=\"gt_row gt_center\"><div data-qmd=\"log\"><div class='gt_from_md'><p>log</p>\n</div></div></td>\n<td headers=\"Range\" class=\"gt_row gt_center\"><div data-qmd=\"$$(0,+\\infty)$$\"><div class='gt_from_md'><p>$$(0,+\\infty)$$</p>\n</div></div></td></tr>\n    <tr><td headers=\"Family\" class=\"gt_row gt_center\"><div data-qmd=\"`binomial`\"><div class='gt_from_md'><p><code>binomial</code></p>\n</div></div></td>\n<td headers=\"Link\" class=\"gt_row gt_center\"><div data-qmd=\"logit\"><div class='gt_from_md'><p>logit</p>\n</div></div></td>\n<td headers=\"Range\" class=\"gt_row gt_center\"><div data-qmd=\"$$\\frac{0, 1, ..., n_{i}}{n_{i}}$$\"><div class='gt_from_md'><p>$$\\frac{0, 1, ..., n_{i}}{n_{i}}$$</p>\n</div></div></td></tr>\n    <tr><td headers=\"Family\" class=\"gt_row gt_center\"><div data-qmd=\"`binomial`\"><div class='gt_from_md'><p><code>binomial</code></p>\n</div></div></td>\n<td headers=\"Link\" class=\"gt_row gt_center\"><div data-qmd=\"probit\"><div class='gt_from_md'><p>probit</p>\n</div></div></td>\n<td headers=\"Range\" class=\"gt_row gt_center\"><div data-qmd=\"$$\\frac{0, 1, ..., n_{i}}{n_{i}}$$\"><div class='gt_from_md'><p>$$\\frac{0, 1, ..., n_{i}}{n_{i}}$$</p>\n</div></div></td></tr>\n    <tr><td headers=\"Family\" class=\"gt_row gt_center\"><div data-qmd=\"`poisson`\"><div class='gt_from_md'><p><code>poisson</code></p>\n</div></div></td>\n<td headers=\"Link\" class=\"gt_row gt_center\"><div data-qmd=\"log\"><div class='gt_from_md'><p>log</p>\n</div></div></td>\n<td headers=\"Range\" class=\"gt_row gt_center\"><div data-qmd=\"$$0, 1, 2, ...$$\"><div class='gt_from_md'><p>$$0, 1, 2, ...$$</p>\n</div></div></td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n:::\n\n\n\n# Relevant distributions {.section}\n\n## Bernoulli distribution\n\nA single Bernoulli trial is defined as:\n\n$$\nf(x, p) = p^x (1 - p)^{1 - x}\n$$\n\nWhere $p$ is the probability of success and $k$ the two possible results $0$ and $1$. The mean is $p$ and the variance is $p(1 - p)$\n\n## Binomial distribution\n\nThe probability of having $k$ success (e.g., 0, 1, 2, etc.), out of $n$ trials with a probability of success $p$ (and failing $q = 1 - p$) is:\n\n$$\nf(n, k, p)= \\binom{n}{k} p^k(1 - p)^{n - k}\n$$\n\nThe $np$ is the mean of the binomial distribution and $np(1 - p)$ is the variance. The binomial distribution is just the repetition of $n$ independent Bernoulli trials.\n\n## Bernoulli and Binomial\n\nA classical example for a Bernoulli trial is the coin flip. In R:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nn <- 1\np <- 0.7\nrbinom(1, n, p) # a single bernoulli trial\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> [1] 1\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nn <- 10\nrbinom(10, 1, p) # n bernoulli trials\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>  [1] 0 0 1 1 1 0 1 0 1 0\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nrbinom(1, n, p) # binomial version\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> [1] 8\n```\n\n\n:::\n:::\n\n\n\n## Binomial\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-30-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Binomial in R\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\n# generate k (success)\nn <- 50 # number of trials\np <- 0.7 # probability of success\nrbinom(1, n, p)\n#> [1] 31\n\n# let's do several experiments (e.g., participants)\nrbinom(10, n, p)\n#>  [1] 32 28 30 38 29 36 31 36 31 39\n\n# calculate the probability density given k successes\nn <- 50\nk <- 25\np <- 0.5\ndbinom(k, n, p)\n#> [1] 0.1122752\n\n# calculate the probability of doing 0, 1, 2, up to k successes\nn <- 50\nk <- 25\np <- 0.5\npbinom(k, n, p)\n#> [1] 0.5561376\n```\n:::\n\n\n\n## Binomial GLM\n\nThe Bernoulli distributions is used as **random component** when we have a binary dependent variable or the number of successes over the total number of trials:\n\n- Accuracy on a cognitive task\n- Patients recovered or not after a treatment\n- People passing or not the exam\n\n. . .\n\nThe Bernoulli or the Binomial distributions can be used as **random component** when we have a binary dependent variable or the number of successes over the total number of trials.\n\n. . .\n\nWhen fitting a GLM with the binomial distribution we are including linear predictors on the expected value $\\mu$ i.e. the probability of success.\n\n## Binomial GLM\n\nMost of the GLM models deal with a mean-variance relationship:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-32-1.svg){fig-align='center' width=960}\n:::\n:::\n\n\n\n## Poisson distribution\n\nThe number of events $k$ during a fixed time interval (e.g., number of new users on a website in 1 week) is:\n\n\\begin{align*}\nf(k,\\lambda) = Pr(X = k) = \\frac{\\lambda^k e^{-\\lambda}}{k!}\n\\end{align*}\n\nWhere $k$ is the number of occurrences ($k = 0, 1, 2, ...$), $e$ is Euler's number ($e = 2.71828...$) and $!$ is the factorial function. The mean and the variance of the Poisson distribution is $\\lambda$.\n\n## Poisson distribution\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-33-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\nAs $\\lambda$ increases, the distribution is well approximated by a Gaussian distribution, but the Poisson is discrete.\n\n## Poisson distribution in R\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nn <- 1000\nx <- rpois(n, lambda = 30)\n\nmean(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> [1] 29.79\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nvar(x)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> [1] 29.25516\n```\n\n\n:::\n:::\n\n\n\nWe can also use all the other functions such as the `dpois()`, `qpois()` and `ppois()`\n\n## Poisson distribution in R\n\nThe mean-variance relationship can be easily seen with a continuous predictor:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-35-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Gamma distribution\n\nThe Gamma distribution has several [:parametrizations](https://en.wikipedia.org/wiki/Gamma_distribution). One of the most common is the **shape-scale** parametrization:\n\n$$\nf(x;k,\\theta )={\\frac {x^{k-1}e^{-x/\\theta }}{\\theta ^{k}\\Gamma (k)}}\n$$\nWhere $\\theta$ is the **scale** parameter and $k$ is the **shape** parameter.\n\n## Gamma distribution\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggamma(mean = c(10, 20, 30), sd = c(10, 10, 10), show = \"ss\")\n```\n\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-36-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## Gamma $\\mu$ and $\\sigma^2$\n\nThe mean and variance are defined as:\n\n- $\\mu = k \\theta$ and $\\sigma^2 = k \\theta^2$ with the **shape-scale** parametrization\n- $\\mu = \\frac{\\alpha}{\\beta}$ and $\\frac{\\alpha}{\\beta^2}$ with the **shape-rate** parametrization\n\n. . .\n\nAnother important quantity is the **coefficient of variation** defined as $\\frac{\\sigma}{\\mu}$ or $\\frac{1}{\\sqrt{k}}$ (or $\\frac{1}{\\sqrt{\\alpha}}$).\n\n## Gamma distribution\n\nAgain, we can see the mean-variance relationship:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggamma(shape = c(5, 5), scale = c(10, 20), show = \"ss\")\n```\n\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-37-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n\n## Gamma parametrization\n\nTo convert between different parametrizations, you can use the `gamma_params()` function:\n\n\n\n::: {.cell layout-align=\"center\"}\n```r\ngamma_params <- function(shape = NULL, scale = 1/rate, rate = 1,\n                         mean = NULL, sd = NULL,\n                         eqs = FALSE){\n  if(eqs){\n    cat(rep(\"=\", 25), \"\\n\")\n    cat(eqs()$gamma, \"\\n\")\n    cat(rep(\"=\", 25), \"\\n\")\n  }else{\n      if(is.null(shape)){\n      var <- sd^2\n      shape <- mean^2 / var\n      scale <- mean / shape\n      rate <- 1/scale\n    } else if(is.null(mean) & is.null(sd)){\n      if(is.null(rate)){\n        scale <- 1/rate\n      } else{\n        rate <- 1/scale\n      }\n      mean <- shape * scale\n      var <- shape * scale^2\n      sd <- sqrt(var)\n    }else{\n      stop(\"when shape and scale are provided, mean and sd need to be NULL (and viceversa)\")\n    }\n    out <- list(shape = shape, scale = scale, rate = rate, mean = mean, var = var, sd = sd)\n    # coefficient of variation\n    out$cv <- 1/sqrt(shape)\n    return(out)\n  }\n}\n```\n:::\n\n\n\n## Gamma parametrization\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\ngm <- gamma_params(mean = 30, sd = 10)\nunlist(gm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>       shape       scale        rate        mean         var          sd \n#>   9.0000000   3.3333333   0.3000000  30.0000000 100.0000000  10.0000000 \n#>          cv \n#>   0.3333333\n```\n\n\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\ny <- rgamma(1000, shape = gm$shape, scale = gm$scale)\n```\n:::\n\n\n\n## Gamma parametrization\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](01-intro-glm_files/figure-revealjs/unnamed-chunk-40-1.svg){fig-align='center' width=672}\n:::\n:::\n\n\n\n## GLM in R\n\nIs not always easy to work with link functions. In R we can use the `distribution(link = )` function to have several useful information. For example:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-fold=\"false\"}\nfam <- binomial(link = \"logit\")\nfam$linkfun() # link function, from probability to eta\nfam$linkinv() # inverse of the link function, from eta to probability\n```\n:::\n\n\n\nWe are going to see the specific arguments, but this tricks works for any family and links, even if you do not remember the specific function or formula.\n\n## References {.refs}\n",
    "supporting": [
      "01-intro-glm_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}